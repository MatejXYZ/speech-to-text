(()=>{var e={76:e=>{e.exports='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.40137 4.5C9.92008 3.6033 10.8896 3 12 3C13.6569 3 15 4.34315 15 6V10M18 12C18 12.3407 17.9716 12.6748 17.9171 13M3 3L21 21M12 18C8.68629 18 6 15.3137 6 12M12 18C12.3407 18 12.6748 17.9716 13 17.917M12 18V21M12 21H15M12 21H9" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>'},260:e=>{e.exports='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 12C18 15.3137 15.3137 18 12 18M12 18C8.68629 18 6 15.3137 6 12M12 18V21M12 21H15M12 21H9M15 6V12C15 13.6569 13.6569 15 12 15C10.3431 15 9 13.6569 9 12V6C9 4.34315 10.3431 3 12 3C13.6569 3 15 4.34315 15 6Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>'},339:()=>{},108:()=>{},275:()=>{},505:()=>{},146:()=>{},173:()=>{},137:()=>{},592:()=>{}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,i),s.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";class e{constructor(e,t){this.privActualSampleRate=e,this.privDesiredSampleRate=t}encode(e){const t=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!t)return null;const i=2*t.length,r=new ArrayBuffer(i),n=new DataView(r);return this.floatTo16BitPCM(n,0,t),r}setString(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}floatTo16BitPCM(e,t,i){for(let r=0;r<i.length;r++,t+=2){const n=Math.max(-1,Math.min(1,i[r]));e.setInt16(t,n<0?32768*n:32767*n,!0)}}downSampleAudioFrame(e,t,i){if(!e)return null;if(i===t||i>t)return e;const r=t/i,n=Math.round(e.length/r),s=new Float32Array(n);let o=0,a=0;for(;a<n;){const t=Math.round((a+1)*r);let i=0,n=0;for(;o<t&&o<e.length;)i+=e[o++],n++;s[a++]=i/n}return s}}class t{constructor(e){this.privStopInputOnRelease=e}record(t,i,r){const n=new e(t.sampleRate,16e3),s=t.createMediaStreamSource(i),o=()=>{const e=(()=>{let e=0;try{return t.createScriptProcessor(e,1,1)}catch(i){e=2048;let r=t.sampleRate;for(;e<16384&&r>=32e3;)e<<=1,r>>=1;return t.createScriptProcessor(e,1,1)}})();e.onaudioprocess=e=>{const t=e.inputBuffer.getChannelData(0);if(r&&!r.isClosed){const e=n.encode(t);e&&r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(e),e.connect(t.destination),this.privMediaResources={scriptProcessorNode:e,source:s,stream:i}};if(t.audioWorklet){if(!this.privSpeechProcessorScript){const e=new Blob(["class SP extends AudioWorkletProcessor {\n                    constructor(options) {\n                      super(options);\n                    }\n                    process(inputs, outputs) {\n                      const input = inputs[0];\n                      const output = [];\n                      for (let channel = 0; channel < input.length; channel += 1) {\n                        output[channel] = input[channel];\n                      }\n                      this.port.postMessage(output[0]);\n                      return true;\n                    }\n                  }\n                  registerProcessor('speech-processor', SP);"],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(e)}t.audioWorklet.addModule(this.privSpeechProcessorScript).then((()=>{const e=new AudioWorkletNode(t,"speech-processor");e.port.onmessage=e=>{const t=e.data;if(r&&!r.isClosed){const e=n.encode(t);e&&r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}},s.connect(e),e.connect(t.destination),this.privMediaResources={scriptProcessorNode:e,source:s,stream:i}})).catch((()=>{o()}))}else try{o()}catch(e){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${e}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach((e=>e.stop())),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}}var r,n,s,o,a,c;!function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_IntentRegion=9]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=10]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=11]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=12]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=13]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=14]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=15]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=16]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=17]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=18]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=19]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=20]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=21]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=22]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=23]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=24]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=25]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=26]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=27]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=28]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=29]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=30]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=31]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=32]="Speech_SegmentationSilenceTimeoutMs",e[e.SpeechServiceConnection_EnableAudioLogging=33]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=34]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=35]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceResponse_ProfanityOption=36]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=37]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=38]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=39]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=40]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=41]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=42]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=43]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=44]="SpeechServiceResponse_RequestSentenceBoundary",e[e.Conversation_ApplicationId=45]="Conversation_ApplicationId",e[e.Conversation_DialogType=46]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=47]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=48]="Conversation_From_Id",e[e.Conversation_Conversation_Id=49]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=50]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=51]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=52]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=53]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=54]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=55]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=56]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=57]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=58]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=59]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=60]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=61]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=62]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=63]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=64]="PronunciationAssessment_Params",e[e.SpeakerRecognition_Api_Version=65]="SpeakerRecognition_Api_Version"}(r||(r={})),function(e){e[e.Interactive=0]="Interactive",e[e.Conversation=1]="Conversation",e[e.Dictation=2]="Dictation"}(n||(n={})),function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(s||(s={}));class h{constructor(e,t){this.privSpeechServiceConfig=e||new p(new u(null)),this.privParameters=t,this.privMaxRetryCount=parseInt(t.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=t.getProperty(r.SpeechServiceConnection_LanguageIdMode,void 0)}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(e){this.privRecognitionMode=e,this.privRecognitionActivityTimeout=e===n.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=n[e]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==n.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(r.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(r.SpeechServiceConnection_RecognitionEndpointVersion,void 0)}get sourceLanguageModels(){const e=[];let t=!1;if(void 0!==this.autoDetectSourceLanguages)for(const i of this.autoDetectSourceLanguages.split(",")){const n=i+r.SpeechServiceConnection_EndpointId.toString(),s=this.parameters.getProperty(n,void 0);void 0!==s?(e.push({language:i,endpoint:s}),t=!0):e.push({language:i,endpoint:""})}return t?e:void 0}get maxRetryCount(){return this.privMaxRetryCount}}class p{constructor(e){this.context=e}serialize(){return JSON.stringify(this,((e,t)=>{if(t&&"object"==typeof t){const e={};for(const i in t)Object.hasOwnProperty.call(t,i)&&(e[i&&i.charAt(0).toLowerCase()+i.substring(1)]=t[i]);return e}return t}))}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(e){this.recognition=e.toLowerCase()}}class u{constructor(e){this.system=new d,this.os=e}}class d{constructor(){this.name="SpeechSDK",this.version="1.25.1",this.build="JavaScript",this.lang="JavaScript"}}class v{constructor(e,t,i){this.platform=e,this.name=t,this.version=i}}!function(e){e.Bluetooth="Bluetooth",e.Wired="Wired",e.WiFi="WiFi",e.Cellular="Cellular",e.InBuilt="InBuilt",e.Unknown="Unknown"}(o||(o={})),function(e){e.Phone="Phone",e.Speaker="Speaker",e.Car="Car",e.Headset="Headset",e.Thermostat="Thermostat",e.Microphones="Microphones",e.Deskphone="Deskphone",e.RemoteControl="RemoteControl",e.Unknown="Unknown",e.File="File",e.Stream="Stream"}(a||(a={}));var l=new Uint8Array(16);function f(){if(!c&&!(c="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return c(l)}const S=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,m=function(e){return"string"==typeof e&&S.test(e)};for(var g=[],y=0;y<256;++y)g.push((y+256).toString(16).substr(1));const C=function(e,t,i){var r=(e=e||{}).random||(e.rng||f)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){i=i||0;for(var n=0;n<16;++n)t[i+n]=r[n];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase();if(!m(i))throw TypeError("Stringified UUID is invalid");return i}(r)},w=()=>C().replace(new RegExp("-","g"),"").toUpperCase();class R extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}class I extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}class P extends Error{constructor(e,t){super(t),this.name=e+"ObjectDisposed",this.message=t}}class b{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new P("EventSource");if(this.metadata)for(const t in this.metadata)t&&e.metadata&&(e.metadata[t]||(e.metadata[t]=this.metadata[t]));for(const t in this.privEventListeners)t&&this.privEventListeners[t]&&this.privEventListeners[t](e)}attach(e){const t=w();return this.privEventListeners[t]=e,{detach:()=>(delete this.privEventListeners[t],Promise.resolve())}}attachListener(e){return this.attach((t=>e.onEvent(t)))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach((t=>e.onEvent(t))),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}var E,A,T;!function(e){e[e.None=0]="None",e[e.Resolved=1]="Resolved",e[e.Rejected=2]="Rejected"}(E||(E={}));class M{constructor(){this.resolve=e=>(this.privResolve(e),this),this.reject=e=>(this.privReject(e),this),this.privPromise=new Promise(((e,t)=>{this.privResolve=e,this.privReject=t}))}get promise(){return this.privPromise}}function D(e,t,i){e.then((e=>{try{t&&t(e)}catch(e){if(i)try{if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}catch(e){}}}),(e=>{if(i)try{if(e instanceof Error){const t=e;i(t.name+": "+t.message)}else i(e)}catch(e){}}))}(T=A||(A={}))[T.Debug=0]="Debug",T[T.Info=1]="Info",T[T.Warning=2]="Warning",T[T.Error=3]="Error",T[T.None=4]="None";class O{constructor(e,t){this.privName=e,this.privEventId=w(),this.privEventTime=(new Date).toISOString(),this.privEventType=t,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}class z extends O{constructor(e,t,i=A.Info){super(e,i),this.privAudioSourceId=t}get audioSourceId(){return this.privAudioSourceId}}class k extends z{constructor(e){super("AudioSourceInitializingEvent",e)}}class x extends z{constructor(e){super("AudioSourceReadyEvent",e)}}class B extends z{constructor(e){super("AudioSourceOffEvent",e)}}class L extends z{constructor(e,t){super("AudioSourceErrorEvent",e,A.Error),this.privError=t}get error(){return this.privError}}class N extends z{constructor(e,t,i){super(e,t),this.privAudioNodeId=i}get audioNodeId(){return this.privAudioNodeId}}class _ extends N{constructor(e,t){super("AudioStreamNodeAttachingEvent",e,t)}}class F extends N{constructor(e,t){super("AudioStreamNodeAttachedEvent",e,t)}}class q extends N{constructor(e,t){super("AudioStreamNodeDetachedEvent",e,t)}}class K extends N{constructor(e,t,i){super("AudioStreamNodeErrorEvent",e,t),this.privError=i}get error(){return this.privError}}class U{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(const t of e)this.privList.push(t)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,t){this.throwIfDisposed(),0===e?this.privList.unshift(t):e===this.privList.length?this.privList.push(t):this.privList.splice(e,0,t),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,t){this.throwIfDisposed();const i=this.privList.splice(e,t);return this.triggerSubscriptions(this.privRemoveSubscriptions),i}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[t]=e,{detach:()=>(delete this.privAddSubscriptions[t],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[t]=e,{detach:()=>(delete this.privRemoveSubscriptions[t],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();const t=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[t]=e,{detach:()=>(delete this.privDisposedSubscriptions[t],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){const e=Array();return this.privList.forEach((t=>{e.push(t)})),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let t=0;t<this.length();t++)e(this.privList[t],t)}select(e){this.throwIfDisposed();const t=[];for(let i=0;i<this.privList.length;i++)t.push(e(this.privList[i],i));return new U(t)}where(e){this.throwIfDisposed();const t=new U;for(let i=0;i<this.privList.length;i++)e(this.privList[i],i)&&t.add(this.privList[i]);return t}orderBy(e){this.throwIfDisposed();const t=this.toArray().sort(e);return new U(t)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy(((t,i)=>e(i,t)))}clone(){return this.throwIfDisposed(),new U(this.toArray())}concat(e){return this.throwIfDisposed(),new U(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new U(this.privList.concat(e))}isDisposed(){return null==this.privList}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new P("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(const t in e)t&&e[t]()}}var H,W=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};!function(e){e[e.Dequeue=0]="Dequeue",e[e.Peek=1]="Peek"}(H||(H={}));class V{constructor(e){this.privPromiseStore=new U,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new U,this.privDetachables=[],this.privSubscribers=new U,this.privDetachables.push(this.privList.onAdded((()=>this.drain())))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise((t=>t(e))))}enqueueFromPromise(e){this.throwIfDispose(),e.then((e=>{this.privList.add(e)}),(()=>{}))}dequeue(){this.throwIfDispose();const e=new M;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:H.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();const e=new M;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:H.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return null==this.privSubscribers}drainAndDispose(e,t){return W(this,void 0,void 0,(function*(){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=t,this.privIsDisposing=!0;const i=this.privSubscribers;if(i){for(;i.length()>0;)i.removeFirst().deferral.resolve(void 0);this.privSubscribers===i&&(this.privSubscribers=i)}for(const e of this.privDetachables)yield e.detach();if(this.privPromiseStore.length()>0&&e){const t=[];return this.privPromiseStore.toArray().forEach((e=>{t.push(e)})),Promise.all(t).finally((()=>{this.privSubscribers=null,this.privList.forEach((t=>{e(t)})),this.privList=null})).then()}this.privSubscribers=null,this.privList=null}}))}dispose(e){return W(this,void 0,void 0,(function*(){yield this.drainAndDispose(null,e)}))}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,t=this.privList;if(e&&t){for(;t.length()>0&&e.length()>0&&!this.privIsDisposing;){const i=e.removeFirst();if(i.type===H.Peek)i.deferral.resolve(t.first());else{const e=t.removeFirst();i.deferral.resolve(e)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===t&&(this.privList=t)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed()){if(this.privDisposeReason)throw new I(this.privDisposeReason);throw new P("Queue")}if(this.privIsDisposing)throw new I("Queue disposing")}}var j;class J{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||w(),this.privReaderQueue=new V}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch(e){}}read(){if(this.privIsReadEnded)throw new I("Stream read has already finished");return this.privReaderQueue.dequeue().then((e=>{return t=this,i=void 0,n=function*(){return(void 0===e||e.isEnd)&&(yield this.privReaderQueue.dispose("End of stream reached")),e},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((n=n.apply(t,i||[])).next())}));var t,i,r,n}))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new V)}throwIfClosed(){if(this.privIsWriteEnded)throw new I("Stream closed")}}class $ extends J{constructor(e,t){super(t),this.privTargetChunkSize=e,this.privNextBufferReadyBytes=0}writeStreamChunk(e){if(e.isEnd||0===this.privNextBufferReadyBytes&&e.buffer.byteLength===this.privTargetChunkSize)return void super.writeStreamChunk(e);let t=0;for(;t<e.buffer.byteLength;){void 0===this.privNextBufferToWrite&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=e.timeReceived);const i=Math.min(e.buffer.byteLength-t,this.privTargetChunkSize-this.privNextBufferReadyBytes),r=new Uint8Array(this.privNextBufferToWrite),n=new Uint8Array(e.buffer.slice(t,i+t));r.set(n,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=i,t+=i,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){0===this.privNextBufferReadyBytes||this.isClosed||super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}}class G{static setEventSource(e){if(!e)throw new R("eventSource");G.privInstance=e}static get instance(){return G.privInstance}}G.privInstance=new b,function(e){e[e.PCM=1]="PCM",e[e.MuLaw=2]="MuLaw",e[e.Siren=3]="Siren",e[e.MP3=4]="MP3",e[e.SILKSkype=5]="SILKSkype",e[e.OGG_OPUS=6]="OGG_OPUS",e[e.WEBM_OPUS=7]="WEBM_OPUS",e[e.ALaw=8]="ALaw",e[e.FLAC=9]="FLAC",e[e.OPUS=10]="OPUS"}(j||(j={}));class Q{static getDefaultInputFormat(){return X.getDefaultInputFormat()}static getWaveFormat(e,t,i,r){return new X(e,t,i,r)}static getWaveFormatPCM(e,t,i){return new X(e,t,i)}}class X extends Q{constructor(e=16e3,t=16,i=1,r=j.PCM){super();let n=!0;switch(r){case j.PCM:this.formatTag=1;break;case j.ALaw:this.formatTag=6;break;case j.MuLaw:this.formatTag=7;break;default:n=!1}if(this.bitsPerSample=t,this.samplesPerSec=e,this.channels=i,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),n){this.privHeader=new ArrayBuffer(44);const e=new DataView(this.privHeader);this.setString(e,0,"RIFF"),e.setUint32(4,0,!0),this.setString(e,8,"WAVEfmt "),e.setUint32(16,16,!0),e.setUint16(20,this.formatTag,!0),e.setUint16(22,this.channels,!0),e.setUint32(24,this.samplesPerSec,!0),e.setUint32(28,this.avgBytesPerSec,!0),e.setUint16(32,this.channels*(this.bitsPerSample/8),!0),e.setUint16(34,this.bitsPerSample,!0),this.setString(e,36,"data"),e.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new X}static getAudioContext(e){const t=window.AudioContext||window.webkitAudioContext||!1;if(t)return void 0!==e&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new t({sampleRate:e}):new t;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}}var Z=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class Y{constructor(e,t,i,r){this.privRecorder=e,this.deviceId=t,this.privStreams={},this.privOutputChunkSize=Y.AUDIOFORMAT.avgBytesPerSec/10,this.privId=i||w(),this.privEvents=new b,this.privMediaStream=r||null,this.privIsClosing=!1}get format(){return Promise.resolve(Y.AUDIOFORMAT)}get blob(){return Promise.reject("Not implemented for Mic input")}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new M;try{this.createAudioContext()}catch(e){if(e instanceof Error){const t=e;this.privInitializeDeferral.reject(t.name+": "+t.message)}else this.privInitializeDeferral.reject(e);return this.privInitializeDeferral.promise}const e=window.navigator;let t=e.getUserMedia||e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia;if(e.mediaDevices&&(t=(t,i,r)=>{e.mediaDevices.getUserMedia(t).then(i).catch(r)}),t){const e=()=>{this.onEvent(new k(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new x(this.privId)),this.privInitializeDeferral.resolve()):t({audio:!this.deviceId||{deviceId:this.deviceId},video:!1},(e=>{this.privMediaStream=e,this.onEvent(new x(this.privId)),this.privInitializeDeferral.resolve()}),(e=>{const t=`Error occurred during microphone initialization: ${e}`;this.privInitializeDeferral.reject(t),this.onEvent(new L(this.privId,t))}))};"suspended"===this.privContext.state?this.privContext.resume().then(e).catch((e=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${e}`)})):e()}else{const e="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(e),this.onEvent(new L(e,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(e){return this.onEvent(new _(this.privId,e)),this.listen(e).then((t=>(this.onEvent(new F(this.privId,e)),{detach:()=>Z(this,void 0,void 0,(function*(){return t.readEnded(),delete this.privStreams[e],this.onEvent(new q(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()})))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new q(this.privId,e)))}turnOff(){return Z(this,void 0,void 0,(function*(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&t.close()}this.onEvent(new B(this.privId)),this.privInitializeDeferral&&(yield this.privInitializeDeferral,this.privInitializeDeferral=null),yield this.destroyAudioContext()}))}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then((e=>({bitspersample:Y.AUDIOFORMAT.bitsPerSample,channelcount:Y.AUDIOFORMAT.channels,connectivity:o.Unknown,manufacturer:"Speech SDK",model:e,samplerate:Y.AUDIOFORMAT.samplesPerSec,type:a.Microphones})))}setProperty(e,t){if("MICROPHONE-WorkletSourceUrl"!==e)throw new Error("Property '"+e+"' is not supported on Microphone.");this.privRecorder.setWorkletUrl(t)}getMicrophoneLabel(){const e="microphone";if(void 0!==this.privMicrophoneLabel)return Promise.resolve(this.privMicrophoneLabel);if(void 0===this.privMediaStream||!this.privMediaStream.active)return Promise.resolve(e);this.privMicrophoneLabel=e;const t=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(void 0===t)return Promise.resolve(this.privMicrophoneLabel);const i=new M;return navigator.mediaDevices.enumerateDevices().then((e=>{for(const i of e)if(i.deviceId===t){this.privMicrophoneLabel=i.label;break}i.resolve(this.privMicrophoneLabel)}),(()=>i.resolve(this.privMicrophoneLabel))),i.promise}listen(e){return Z(this,void 0,void 0,(function*(){yield this.turnOn();const t=new $(this.privOutputChunkSize,e);this.privStreams[e]=t;try{this.privRecorder.record(this.privContext,this.privMediaStream,t)}catch(t){throw this.onEvent(new K(this.privId,e,t)),t}return t}))}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}createAudioContext(){this.privContext||(this.privContext=X.getAudioContext(Y.AUDIOFORMAT.samplesPerSec))}destroyAudioContext(){return Z(this,void 0,void 0,(function*(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let e=!1;"close"in this.privContext&&(e=!0),e?this.privIsClosing||(this.privIsClosing=!0,yield this.privContext.close(),this.privContext=null,this.privIsClosing=!1):null!==this.privContext&&"running"===this.privContext.state&&(yield this.privContext.suspend())}))}}Y.AUDIOFORMAT=Q.getDefaultInputFormat();var ee=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class te{constructor(e,t,i){this.privStreams={},this.privHeaderEnd=44,this.privId=i||w(),this.privEvents=new b,this.privSource=e,"undefined"!=typeof window&&"undefined"!=typeof Blob&&this.privSource instanceof Blob?this.privFilename=e.name:this.privFilename=t||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}get blob(){return Promise.resolve(this.privSource)}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const e=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new L(e,"")),Promise.reject(e)}this.onEvent(new k(this.privId)),this.onEvent(new x(this.privId))}id(){return this.privId}attach(e){return ee(this,void 0,void 0,(function*(){this.onEvent(new _(this.privId,e));const t=yield this.upload(e);return this.onEvent(new F(this.privId,e)),Promise.resolve({detach:()=>ee(this,void 0,void 0,(function*(){t.readEnded(),delete this.privStreams[e],this.onEvent(new q(this.privId,e)),yield this.turnOff()})),id:()=>e,read:()=>t.read()})}))}detach(e){e&&this.privStreams[e]&&(this.privStreams[e].close(),delete this.privStreams[e],this.onEvent(new q(this.privId,e)))}turnOff(){for(const e in this.privStreams)if(e){const t=this.privStreams[e];t&&!t.isClosed&&t.close()}return this.onEvent(new B(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then((e=>Promise.resolve({bitspersample:e.bitsPerSample,channelcount:e.channels,connectivity:o.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:e.samplesPerSec,type:a.File})))}readHeader(){const e=this.privSource.slice(0,4296),t=new M,i=e=>{const i=new DataView(e),r=e=>String.fromCharCode(i.getUint8(e),i.getUint8(e+1),i.getUint8(e+2),i.getUint8(e+3));if("RIFF"!==r(0))return void t.reject("Invalid WAV header in file, RIFF was not found");if("WAVE"!==r(8)||"fmt "!==r(12))return void t.reject("Invalid WAV header in file, WAVEfmt was not found");const n=i.getInt32(16,!0),s=i.getUint16(22,!0),o=i.getUint32(24,!0),a=i.getUint16(34,!0);let c=36+Math.max(n-16,0);for(;"data"!==r(c);c+=2)if(c>4288)return void t.reject("Invalid WAV header in file, data block was not found");this.privHeaderEnd=c+8,t.resolve(Q.getWaveFormatPCM(o,a,s))};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&e instanceof Blob){const t=new FileReader;t.onload=e=>{const t=e.target.result;i(t)},t.readAsArrayBuffer(e)}else{const t=e;i(t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength))}return t.promise}upload(e){return ee(this,void 0,void 0,(function*(){const t=t=>{const i=`Error occurred while processing '${this.privFilename}'. ${t}`;throw this.onEvent(new K(this.privId,e,i)),new Error(i)};try{yield this.turnOn();const i=yield this.privAudioFormatPromise,r=new $(i.avgBytesPerSec/10,e);this.privStreams[e]=r;const n=this.privSource.slice(this.privHeaderEnd),s=e=>{r.isClosed||(r.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()}),r.close())};if("undefined"!=typeof window&&"undefined"!=typeof Blob&&n instanceof Blob){const e=new FileReader;e.onerror=e=>t(e.toString()),e.onload=e=>{const t=e.target.result;s(t)},e.readAsArrayBuffer(n)}else{const e=n;s(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}return r}catch(e){t(e)}}))}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}}class ie{static throwIfNullOrUndefined(e,t){if(null==e)throw new Error("throwIfNullOrUndefined:"+t)}static throwIfNull(e,t){if(null===e)throw new Error("throwIfNull:"+t)}static throwIfNullOrWhitespace(e,t){if(ie.throwIfNullOrUndefined(e,t),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+t)}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,t){if(ie.throwIfNullOrUndefined(e,t),0===e.length)throw new Error("throwIfArrayEmptyOrWhitespace:"+t);for(const i of e)ie.throwIfNullOrWhitespace(i,t)}static throwIfFileDoesNotExist(e,t){ie.throwIfNullOrWhitespace(e,t)}static throwIfNotUndefined(e,t){if(void 0!==e)throw new Error("throwIfNotUndefined:"+t)}}class re{}var ne,se,oe,ae,ce,he,pe=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class ue{constructor(){}static createPushStream(e){return de.create(e)}static createPullStream(e,t){return le.create(e,t)}}class de extends ue{static create(e){return new ve(e)}}class ve extends de{constructor(e){super(),this.privFormat=void 0===e?X.getDefaultInputFormat():e,this.privEvents=new b,this.privId=w(),this.privStream=new $(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(e){this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}get blob(){return this.attach("id").then((e=>{const t=[];let i=Buffer.from("");const r=()=>e.read().then((e=>!e||e.isEnd?"undefined"!=typeof XMLHttpRequest&&"undefined"!=typeof Blob?Promise.resolve(new Blob(t)):Promise.resolve(Buffer.from(i)):("undefined"!=typeof Blob?t.push(e.buffer):i=Buffer.concat([i,this.toBuffer(e.buffer)]),r())));return r()}))}turnOn(){this.onEvent(new k(this.privId)),this.onEvent(new x(this.privId))}attach(e){return pe(this,void 0,void 0,(function*(){this.onEvent(new _(this.privId,e)),yield this.turnOn();const t=this.privStream;return this.onEvent(new F(this.privId,e)),{detach:()=>pe(this,void 0,void 0,(function*(){return this.onEvent(new q(this.privId,e)),this.turnOff()})),id:()=>e,read:()=>t.read()}}))}detach(e){this.onEvent(new q(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:o.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:a.Stream})}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}toBuffer(e){const t=Buffer.alloc(e.byteLength),i=new Uint8Array(e);for(let e=0;e<t.length;++e)t[e]=i[e];return t}}class le extends ue{constructor(){super()}static create(e,t){return new fe(e,t)}}class fe extends le{constructor(e,t){super(),this.privFormat=void 0===t?Q.getDefaultInputFormat():t,this.privEvents=new b,this.privId=w(),this.privCallback=e,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}get blob(){return Promise.reject("Not implemented")}turnOn(){this.onEvent(new k(this.privId)),this.onEvent(new x(this.privId))}attach(e){return pe(this,void 0,void 0,(function*(){return this.onEvent(new _(this.privId,e)),yield this.turnOn(),this.onEvent(new F(this.privId,e)),{detach:()=>(this.privCallback.close(),this.onEvent(new q(this.privId,e)),this.turnOff()),id:()=>e,read:()=>{let e,t=0;for(;t<this.privBufferSize;){const i=new ArrayBuffer(this.privBufferSize-t),r=this.privCallback.read(i);if(void 0===e?e=i:new Int8Array(e).set(new Int8Array(i),t),0===r)break;t+=r}return Promise.resolve({buffer:e.slice(0,t),isEnd:this.privIsClosed||0===t,timeReceived:Date.now()})}}}))}detach(e){this.onEvent(new q(this.privId,e))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:o.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:a.Stream})}onEvent(e){this.privEvents.onEvent(e),G.instance.onEvent(e)}}!function(e){e[e.Text=0]="Text",e[e.Binary=1]="Binary"}(ne||(ne={}));class Se{constructor(e,t,i,r){if(this.privBody=null,e===ne.Text&&t&&"string"!=typeof t)throw new I("Payload must be a string");if(e===ne.Binary&&t&&!(t instanceof ArrayBuffer))throw new I("Payload must be ArrayBuffer");switch(this.privMessageType=e,this.privBody=t,this.privHeaders=i||{},this.privId=r||w(),this.messageType){case ne.Binary:this.privSize=null!==this.binaryBody?this.binaryBody.byteLength:0;break;case ne.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===ne.Binary)throw new I("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===ne.Text)throw new I("Not supported for text message");return this.privBody}get id(){return this.privId}}class me extends O{constructor(e,t,i=A.Info){super(e,i),this.privJsonResult=t}get jsonString(){return this.privJsonResult}}class ge extends O{constructor(e,t,i=A.Info){super(e,i),this.privConnectionId=t}get connectionId(){return this.privConnectionId}}class ye extends ge{constructor(e,t,i){super("ConnectionStartEvent",e),this.privUri=t,this.privHeaders=i}get uri(){return this.privUri}get headers(){return this.privHeaders}}class Ce extends ge{constructor(e){super("ConnectionEstablishedEvent",e)}}class we extends ge{constructor(e,t,i){super("ConnectionClosedEvent",e,A.Debug),this.privReason=i,this.privStatusCode=t}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class Re extends ge{constructor(e,t,i){super("ConnectionErrorEvent",e,A.Debug),this.privMessage=t,this.privType=i}get message(){return this.privMessage}get type(){return this.privType}}class Ie extends ge{constructor(e,t,i){super("ConnectionEstablishErrorEvent",e,A.Error),this.privStatusCode=t,this.privReason=i}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}class Pe extends ge{constructor(e,t,i){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=t,this.privMessage=i}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}class be extends ge{constructor(e,t,i){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=t,this.privMessage=i}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}!function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(se||(se={})),function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(oe||(oe={})),function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"}(ae||(ae={}));class Ee{constructor(e){this.privResult=e}get result(){return this.privResult}}class Ae{constructor(e,t,i,r){this.privResultId=e,this.privReason=t,this.privErrorDetails=i,this.privProperties=r}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}class Te extends Ae{constructor(e,t,i,r,n,s){super(e,t,r,n),this.privAudioData=i,this.privAudioDuration=s}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}}!function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile",e[e.VoicesListRetrieved=18]="VoicesListRetrieved"}(ce||(ce={}));class Me{constructor(){this.privKeys=[],this.privValues=[]}getProperty(e,t){let i;i="string"==typeof e?e:r[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===i)return this.privValues[e];if(void 0!==t)return String(t)}setProperty(e,t){let i;i="string"==typeof e?e:r[e];for(let e=0;e<this.privKeys.length;e++)if(this.privKeys[e]===i)return void(this.privValues[e]=t);this.privKeys.push(i),this.privValues.push(t)}clone(){const e=new Me;for(let t=0;t<this.privKeys.length;t++)e.privKeys.push(this.privKeys[t]),e.privValues.push(this.privValues[t]);return e}mergeTo(e){this.privKeys.forEach((t=>{if(void 0===e.getProperty(t,void 0)){const i=this.getProperty(t);e.setProperty(t,i)}}))}get keys(){return this.privKeys}}class De{constructor(e,t,i,r,n,s){this.privAudioOffset=e,this.privDuration=t,this.privText=i,this.privWordLength=r,this.privTextOffset=n,this.privBoundaryType=s}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}class Oe{constructor(e,t){this.privAudioOffset=e,this.privText=t}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}class ze{constructor(e,t,i){this.privAudioOffset=e,this.privVisemeId=t,this.privAnimation=i}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}!function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm"}(he||(he={}));class ke extends X{constructor(e,t,i,r,n,s,o,a,c){super(i,s,t,e),this.formatTag=e,this.avgBytesPerSec=r,this.blockAlign=n,this.priAudioFormatString=o,this.priRequestAudioFormatString=a,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return void 0===e?ke.getDefaultOutputFormat():ke.fromSpeechSynthesisOutputFormatString(ke.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new ke(j.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new ke(j.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new ke(j.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new ke(j.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new ke(j.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new ke(j.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new ke(j.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new ke(j.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new ke(j.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new ke(j.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new ke(j.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new ke(j.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new ke(j.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new ke(j.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new ke(j.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new ke(j.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new ke(j.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new ke(j.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new ke(j.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new ke(j.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new ke(j.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new ke(j.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new ke(j.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new ke(j.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new ke(j.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new ke(j.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new ke(j.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new ke(j.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new ke(j.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new ke(j.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new ke(j.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new ke(j.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new ke(j.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new ke(j.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new ke(j.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new ke(j.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new ke(j.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new ke(j.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);default:return new ke(j.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return ke.fromSpeechSynthesisOutputFormatString("undefined"!=typeof window?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){const t=new DataView(this.privHeader);t.setUint32(4,e+this.privHeader.byteLength-8,!0),t.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}}ke.SpeechSynthesisOutputFormatToString={[he.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[he.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[he.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[he.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[he.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[he.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[he.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[he.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[he.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[he.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[he.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[he.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[he.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[he.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[he.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[he.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[he.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[he.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[he.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[he.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[he.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[he.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[he.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[he.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[he.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[he.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[he.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[he.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[he.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[he.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[he.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[he.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[he.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[he.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[he.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[he.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[he.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm"};var xe;class Be{constructor(){}static createPullStream(){return Le.create()}}class Le extends Be{static create(){return new Ne}}class Ne extends Le{constructor(){super(),this.privId=w(),this.privStream=new J}set format(e){null==e&&(this.privFormat=ke.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}read(e){return t=this,i=void 0,n=function*(){const t=new Int8Array(e);let i=0;if(void 0!==this.privLastChunkView){if(this.privLastChunkView.length>e.byteLength)return t.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);t.set(this.privLastChunkView),i=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;i<e.byteLength&&!this.privStream.isReadEnded;){const r=yield this.privStream.read();if(void 0===r||r.isEnd)this.privStream.readEnded();else{let n;r.buffer.byteLength>e.byteLength-i?(n=r.buffer.slice(0,e.byteLength-i),this.privLastChunkView=new Int8Array(r.buffer.slice(e.byteLength-i))):n=r.buffer,t.set(new Int8Array(n),i),i+=n.byteLength}}return i},new((r=void 0)||(r=Promise))((function(e,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}c((n=n.apply(t,i||[])).next())}));var t,i,r,n}write(e){ie.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}class _e extends Be{constructor(){super()}static create(e){return new Fe(e)}}class Fe extends _e{constructor(e){super(),this.privId=w(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}!function(e){e.WordBoundary="WordBoundary",e.Bookmark="Bookmark",e.Viseme="Viseme",e.SentenceBoundary="SentenceBoundary",e.SessionEnd="SessionEnd"}(xe||(xe={}));class qe{constructor(e){this.privSynthesisAudioMetadata=JSON.parse(e)}static fromJSON(e){return new qe(e)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}class Ke extends O{constructor(e,t,i=A.Info){super(e,i),this.privRequestId=t}get requestId(){return this.privRequestId}}class Ue extends Ke{constructor(e,t,i){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=t,this.privTurnAudioDestinationId=i}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}class He extends Ke{constructor(e,t){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}class We extends Ke{constructor(e,t){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=t}get authFetchEventId(){return this.privAuthFetchEventId}}var Ve=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class je{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=w(),this.privTurnDeferral=new M,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(e){this.privStreamId=e}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(e){this.privAudioOutputFormat=e}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}getAllReceivedAudio(){return Ve(this,void 0,void 0,(function*(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(yield this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}))}getAllReceivedAudioWithHeader(){return Ve(this,void 0,void 0,(function*(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const e=yield this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=it.addHeader(e,this.audioOutputFormat),this.privReceivedAudioWithHeader}return this.getAllReceivedAudio()}))}startNewSynthesis(e,t,i,r){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=e,this.privRawText=t,this.privIsSSML=i,this.privAudioOutputStream=new Ne,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",void 0!==r&&(this.privTurnAudioDestination=r,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new Ue(this.requestId,void 0,void 0===r?void 0:r.id()))}onPreConnectionStart(e){this.privAuthFetchEventId=e,this.onEvent(new He(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){if(200===e)return this.onEvent(new We(this.requestId,this.privAuthFetchEventId)),void(this.privBytesReceived=0);403===e&&this.onComplete()}onServiceResponseMessage(e){const t=JSON.parse(e);this.streamId=t.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new M}onAudioChunkReceived(e){this.isSynthesizing&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength,void 0!==this.privTurnAudioDestination&&this.privTurnAudioDestination.write(e))}onTextBoundaryEvent(e){this.updateTextOffset(e.Data.text.Text,e.Type)}onVisemeMetadataReceived(e){void 0!==e.Data.AnimationChunk&&(this.privPartialVisemeAnimation+=e.Data.AnimationChunk)}onSessionEnd(e){this.privAudioDuration=e.Data.Offset}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const e=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",e}onEvent(e){G.instance.onEvent(e)}static isXmlTag(e){return e.length>=2&&"<"===e[0]&&">"===e[e.length-1]}updateTextOffset(e,t){t===xe.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(e,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!je.isXmlTag(e)&&this.updateTextOffset(e,t))):(this.privSentenceOffset=this.privRawText.indexOf(e,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+e.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!je.isXmlTag(e)&&this.updateTextOffset(e,t)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,void 0!==this.privTurnAudioDestination&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}readAllAudioFromStream(){return Ve(this,void 0,void 0,(function*(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{yield this.privAudioOutputStream.read(this.privReceivedAudio)}catch(e){this.privReceivedAudio=new ArrayBuffer(0)}}}))}withinXmlTag(e){return this.privRawText.indexOf("<",e+1)>this.privRawText.indexOf(">",e+1)}}class Je{constructor(e){this.privContext={},this.privSpeechSynthesizer=e}setSection(e,t){this.privContext[e]=t}set audioOutputFormat(e){this.privAudioOutputFormat=e}toJSON(){const e=this.buildSynthesisContext();return this.setSection("synthesis",e),JSON.stringify(this.privContext)}buildSynthesisContext(){return{audio:{metadataOptions:{bookmarkEnabled:!!this.privSpeechSynthesizer.bookmarkReached,punctuationBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(r.SpeechServiceResponse_RequestPunctuationBoundary,!!this.privSpeechSynthesizer.wordBoundary),sentenceBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(r.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!this.privSpeechSynthesizer.visemeReceived,wordBoundaryEnabled:this.privSpeechSynthesizer.properties.getProperty(r.SpeechServiceResponse_RequestWordBoundary,!!this.privSpeechSynthesizer.wordBoundary)},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:this.privSpeechSynthesizer.autoDetectSourceLanguage}}}}class $e{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}const Ge="OutputFormat",Qe="CancellationErrorCode",Xe="ServiceProperties",Ze="ForceDictation";class Ye{}Ye.AuthKey="Ocp-Apim-Subscription-Key",Ye.Authorization="Authorization",Ye.ConnectionId="X-ConnectionId",Ye.ContentType="Content-Type",Ye.CustomCommandsAppId="X-CommandsAppId",Ye.Path="Path",Ye.RequestId="X-RequestId",Ye.RequestStreamId="X-StreamId",Ye.RequestTimestamp="X-Timestamp";class et extends Se{constructor(e,t,i,r,n,s,o,a){if(!t)throw new R("path");if(!i)throw new R("requestId");const c={};if(c[Ye.Path]=t,c[Ye.RequestId]=i,c[Ye.RequestTimestamp]=(new Date).toISOString(),r&&(c[Ye.ContentType]=r),s&&(c[Ye.RequestStreamId]=s),o)for(const e in o)e&&(c[e]=o[e]);a?super(e,n,c,a):super(e,n,c),this.privPath=t,this.privRequestId=i,this.privContentType=r,this.privStreamId=s,this.privAdditionalHeaders=o}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let t=null,i=null,r=null,n=null;const s={};if(e.headers)for(const o in e.headers)o&&(o.toLowerCase()===Ye.Path.toLowerCase()?t=e.headers[o]:o.toLowerCase()===Ye.RequestId.toLowerCase()?i=e.headers[o]:o.toLowerCase()===Ye.ContentType.toLowerCase()?r=e.headers[o]:o.toLowerCase()===Ye.RequestStreamId.toLowerCase()?n=e.headers[o]:s[o]=e.headers[o]);return new et(e.messageType,t,i,r,e.body,n,s,e.id)}}var tt=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class it{constructor(e,t,i,r,n){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!e)throw new R("authentication");if(!t)throw new R("connectionFactory");if(!i)throw new R("synthesizerConfig");this.privAuthentication=e,this.privConnectionFactory=t,this.privSynthesizerConfig=i,this.privIsDisposed=!1,this.privSpeechSynthesizer=r,this.privSessionAudioDestination=n,this.privSynthesisTurn=new je,this.privConnectionEvents=new b,this.privServiceEvents=new b,this.privSynthesisContext=new Je(this.privSpeechSynthesizer),this.privAgentConfig=new $e,this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;1e3!==t.statusCode&&this.cancelSynthesisLocal(oe.Error,1007===t.statusCode?ae.BadRequestParameters:ae.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}))}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(e){this.privAudioOutputFormat=e,this.privSynthesisTurn.audioOutputFormat=e,void 0!==this.privSessionAudioDestination&&(this.privSessionAudioDestination.format=e),void 0!==this.synthesisContext&&(this.synthesisContext.audioOutputFormat=e)}static addHeader(e,t){if(!t.hasHeader)return e;t.updateHeader(e.byteLength);const i=new Uint8Array(e.byteLength+t.header.byteLength);return i.set(new Uint8Array(t.header),0),i.set(new Uint8Array(e),t.header.byteLength),i.buffer}isDisposed(){return this.privIsDisposed}dispose(e){return tt(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.close(),void 0!==this.privConnectionConfigurationPromise){const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}}))}connect(){return tt(this,void 0,void 0,(function*(){yield this.connectImpl()}))}sendNetworkMessage(e,t){return tt(this,void 0,void 0,(function*(){const i="string"==typeof t?ne.Text:ne.Binary,r="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new et(i,e,this.privSynthesisTurn.requestId,r,t))}))}Speak(e,t,i,r,n,s){return tt(this,void 0,void 0,(function*(){let o;if(o=t?e:this.privSpeechSynthesizer.buildSsml(e),void 0!==this.speakOverride)return this.speakOverride(o,i,r,n);this.privSuccessCallback=r,this.privErrorCallback=n,this.privSynthesisTurn.startNewSynthesis(i,e,t,s);try{yield this.connectImpl();const e=yield this.fetchConnection();yield this.sendSynthesisContext(e),yield this.sendSsmlMessage(e,o,i);const t=new Ee(new Te(i,ce.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,t),this.receiveMessage()}catch(e){return this.cancelSynthesisLocal(oe.Error,ae.ConnectionFailure,e),Promise.reject(e)}}))}cancelSynthesis(e,t,i,r){const n=new Me;n.setProperty(Qe,ae[i]);const s=new Te(e,ce.Canceled,void 0,r,n);if(this.privSpeechSynthesizer.SynthesisCanceled){const e=new Ee(s);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,e)}catch(e){}}if(this.privSuccessCallback)try{this.privSuccessCallback(s)}catch(e){}}cancelSynthesisLocal(e,t,i){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,e,t,i))}processTypeSpecificMessages(e){return!0}receiveMessage(){return tt(this,void 0,void 0,(function*(){try{const e=yield this.fetchConnection(),t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!t)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const i=et.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse();break;case"response":this.privSynthesisTurn.onServiceResponseMessage(i.textBody);break;case"audio":if(this.privSynthesisTurn.streamId.toLowerCase()===i.streamId.toLowerCase()&&i.binaryBody){if(this.privSynthesisTurn.onAudioChunkReceived(i.binaryBody),this.privSpeechSynthesizer.synthesizing)try{const e=it.addHeader(i.binaryBody,this.privSynthesisTurn.audioOutputFormat),t=new Ee(new Te(this.privSynthesisTurn.requestId,ce.SynthesizingAudio,e));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,t)}catch(e){}void 0!==this.privSessionAudioDestination&&this.privSessionAudioDestination.write(i.binaryBody)}break;case"audio.metadata":const e=qe.fromJSON(i.textBody).Metadata;for(const t of e)switch(t.Type){case xe.WordBoundary:case xe.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(t);const e=new De(t.Data.Offset,t.Data.Duration,t.Data.text.Text,t.Data.text.Length,t.Type===xe.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,t.Data.text.BoundaryType);if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,e)}catch(e){}break;case xe.Bookmark:const i=new Oe(t.Data.Offset,t.Data.Bookmark);if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,i)}catch(e){}break;case xe.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(t),t.Data.IsLastAnimation){const e=new ze(t.Data.Offset,t.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,e)}catch(e){}}break;case xe.SessionEnd:this.privSynthesisTurn.onSessionEnd(t)}break;case"turn.end":let t;this.privSynthesisTurn.onServiceTurnEndResponse();try{const e=yield this.privSynthesisTurn.getAllReceivedAudioWithHeader();t=new Te(this.privSynthesisTurn.requestId,ce.SynthesizingAudioCompleted,e,void 0,void 0,this.privSynthesisTurn.audioDuration),this.privSuccessCallback&&this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new Ee(t))}catch(e){}break;default:this.processTypeSpecificMessages(i)||this.privServiceEvents&&this.serviceEvents.onEvent(new me(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch(e){}}))}sendSynthesisContext(e){const t=this.synthesisContext.toJSON();if(t)return e.send(new et(ne.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",t))}connectImpl(e=!1){if(null!=this.privConnectionPromise)return this.privConnectionPromise.then((e=>e.state()===se.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl())));this.privAuthFetchEventId=w(),this.privConnectionId=w(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=t.then((t=>tt(this,void 0,void 0,(function*(){this.privSynthesisTurn.onAuthCompleted(!1);const i=this.privConnectionFactory.create(this.privSynthesizerConfig,t,this.privConnectionId);i.events.attach((e=>{this.connectionEvents.onEvent(e)}));const n=yield i.open();return 200===n.statusCode?(this.privSynthesisTurn.onConnectionEstablishCompleted(n.statusCode),Promise.resolve(i)):403!==n.statusCode||e?(this.privSynthesisTurn.onConnectionEstablishCompleted(n.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${n.statusCode}, ${this.privSynthesizerConfig.parameters.getProperty(r.SpeechServiceConnection_Endpoint)} Reason: ${n.reason}`)):this.connectImpl(!0)}))),(e=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(e)})),this.privConnectionPromise.catch((()=>{})),this.privConnectionPromise}sendSpeechServiceConfig(e,t){if(t)return e.send(new et(ne.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",t))}sendSsmlMessage(e,t,i){return e.send(new et(ne.Text,"ssml",i,"application/ssml+xml",t))}fetchConnection(){return tt(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===se.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}configureConnection(){return tt(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),e)}))}}it.telemetryDataEnabled=!0;class rt extends O{constructor(e){super("BackgroundEvent",A.Error),this.privError=e}get error(){return this.privError}}var nt=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};const st={[j.PCM]:"audio/wav",[j.MuLaw]:"audio/x-wav",[j.MP3]:"audio/mpeg",[j.OGG_OPUS]:"audio/ogg",[j.WEBM_OPUS]:"audio/webm; codecs=opus",[j.ALaw]:"audio/x-wav",[j.FLAC]:"audio/flac"};class ot{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||w(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,t,i){void 0!==this.privAudioBuffer?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then((()=>{t&&t()}),(e=>{i&&i(e)}))):void 0!==this.privAudioOutputStream&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,t){if(this.privIsClosed=!0,void 0!==this.privSourceBuffer)this.handleSourceBufferUpdateEnd().then((()=>{e&&e()}),(e=>{t&&t(e)}));else if(void 0!==this.privAudioOutputStream&&"undefined"!=typeof window)if(this.privFormat.formatTag!==j.PCM&&this.privFormat.formatTag!==j.MuLaw&&this.privFormat.formatTag!==j.ALaw||!1!==this.privFormat.hasHeader){let i=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(i).then((()=>{i=it.addHeader(i,this.privFormat);const r=new Blob([i],{type:st[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(r),this.notifyPlayback().then((()=>{e&&e()}),(e=>{t&&t(e)}))}),(e=>{t&&t(e)}))}else console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if("undefined"!=typeof AudioContext||"undefined"!=typeof window&&void 0!==window.webkitAudioContext){this.privFormat=e;const t=st[this.privFormat.formatTag];void 0===t?console.warn(`Unknown mimeType for format ${j[this.privFormat.formatTag]}; playback is not supported.`):"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported(t)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=1800,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(t),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch((e=>{G.instance.onEvent(new rt(e))}))},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch((e=>{G.instance.onEvent(new rt(e))}))},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch((e=>{G.instance.onEvent(new rt(e))}))):(console.warn(`Format ${j[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new Ne,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var e,t;return null!==(t=null===(e=this.privAudio)||void 0===e?void 0:e.volume)&&void 0!==t?t:-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return void 0!==this.privAudio?this.privAudio.currentTime:-1}pause(){this.privIsPaused||void 0===this.privAudio||(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,t){this.privIsPaused&&void 0!==this.privAudio&&(this.privAudio.play().then((()=>{e&&e()}),(e=>{t&&t(e)})),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}updateSourceBuffer(){return nt(this,void 0,void 0,(function*(){if(void 0!==this.privAudioBuffer&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch(t){return this.privAudioBuffer.unshift(e),void console.log("buffer filled, pausing addition of binaries until space is made")}yield this.notifyPlayback()}else this.canEndStream()&&(yield this.handleSourceBufferUpdateEnd())}))}handleSourceBufferUpdateEnd(){return nt(this,void 0,void 0,(function*(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),yield this.notifyPlayback())}))}notifyPlayback(){return nt(this,void 0,void 0,(function*(){this.privPlaybackStarted||void 0===this.privAudio||(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||(yield this.privAudio.play()))}))}canEndStream(){return this.isClosed&&void 0!==this.privSourceBuffer&&0===this.privAudioBuffer.length&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&"open"===this.privMediaSource.readyState}sourceBufferAvailable(){return void 0!==this.privSourceBuffer&&!this.privSourceBuffer.updating}}class at{}var ct,ht,pt,ut,dt,vt=i(592);class lt{constructor(e){ie.throwIfNullOrUndefined(vt.openSync,"\nFile System access not available, please use Push or PullAudioOutputStream"),this.privFd=vt.openSync(e,"w")}set format(e){ie.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let t=0;this.privAudioFormat.hasHeader&&(t=this.privAudioFormat.header.byteLength),void 0!==this.privFd&&(this.privWriteStream=vt.createWriteStream("",{fd:this.privFd,start:t,autoClose:!1}))}write(e){ie.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),void 0!==this.privWriteStream&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){void 0!==this.privFd&&(this.privWriteStream.on("finish",(()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),vt.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),vt.closeSync(this.privFd),this.privFd=void 0})),this.privWriteStream.end())}id(){return this.privId}}class ft{static fromDefaultMicrophoneInput(){const e=new t(!0);return new St(new Y(e))}static fromMicrophoneInput(e){const i=new t(!0);return new St(new Y(i,e))}static fromWavFileInput(e,t="unnamedBuffer.wav"){return new St(new te(e,t))}static fromStreamInput(e){if(e instanceof re)return new St(new fe(e));if(e instanceof ue)return new St(e);if("undefined"!=typeof MediaStream&&e instanceof MediaStream){const i=new t(!1);return new St(new Y(i,null,null,e))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new mt(new ot)}static fromSpeakerOutput(e){if(void 0===e)return ft.fromDefaultSpeakerOutput();if(e instanceof ot)return new mt(e);throw new Error("Not Supported Type")}static fromAudioFileOutput(e){return new mt(new lt(e))}static fromStreamOutput(e){if(e instanceof at)return new mt(new Fe(e));if(e instanceof _e)return new mt(e);if(e instanceof Le)return new mt(e);throw new Error("Not Supported Type")}}class St extends ft{constructor(e){super(),this.privSource=e}get format(){return this.privSource.format}close(e,t){this.privSource.turnOff().then((()=>{e&&e()}),(e=>{t&&t(e)}))}id(){return this.privSource.id()}get blob(){return this.privSource.blob}turnOn(){return this.privSource.turnOn()}attach(e){return this.privSource.attach(e)}detach(e){return this.privSource.detach(e)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(e,t){if(ie.throwIfNull(t,"value"),void 0===this.privSource.setProperty)throw new Error("This AudioConfig instance does not support setting properties.");this.privSource.setProperty(e,t)}getProperty(e,t){if(void 0!==this.privSource.getProperty)return this.privSource.getProperty(e,t);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}class mt extends ft{constructor(e){super(),this.privDestination=e}set format(e){this.privDestination.format=e}write(e){this.privDestination.write(e)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}!function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(ct||(ct={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"}(ht||(ht={}));class gt{constructor(e){this.privSimpleSpeechPhrase=JSON.parse(e),this.privSimpleSpeechPhrase.RecognitionStatus=ht[this.privSimpleSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new gt(e)}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSimpleSpeechPhrase.PrimaryLanguage?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}}!function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(pt||(pt={}));class yt{constructor(e){this.privReason=e}static fromResult(e){const t=gt.fromJSON(e.json);let i=pt.NotRecognized;switch(t.RecognitionStatus){case ht.BabbleTimeout:i=pt.InitialBabbleTimeout;break;case ht.InitialSilenceTimeout:i=pt.InitialSilenceTimeout;break;default:i=pt.NotRecognized}return new yt(i)}get reason(){return this.privReason}}class Ct{static implTranslateRecognitionResult(e){let t=ce.Canceled;switch(e){case ht.Success:t=ce.RecognizedSpeech;break;case ht.NoMatch:case ht.InitialSilenceTimeout:case ht.BabbleTimeout:case ht.EndOfDictation:t=ce.NoMatch;break;case ht.Error:case ht.BadRequest:case ht.Forbidden:default:t=ce.Canceled}return t}static implTranslateCancelResult(e){let t=oe.EndOfStream;switch(e){case ht.Success:case ht.EndOfDictation:case ht.NoMatch:t=oe.EndOfStream;break;case ht.InitialSilenceTimeout:case ht.BabbleTimeout:case ht.Error:case ht.BadRequest:case ht.Forbidden:default:t=oe.Error}return t}static implTranslateCancelErrorCode(e){let t=ae.NoError;switch(e){case ht.Error:t=ae.ServiceError;break;case ht.TooManyRequests:t=ae.TooManyRequests;break;case ht.BadRequest:t=ae.BadRequestParameters;break;case ht.Forbidden:t=ae.Forbidden;break;default:t=ae.NoError}return t}static implTranslateErrorDetails(e){let t="The speech service encountered an internal error and could not continue.";switch(e){case ae.Forbidden:t="The recognizer is using a free subscription that ran out of quota.";break;case ae.BadRequestParameters:t="Invalid parameter or unsupported audio format in the request.";break;case ae.TooManyRequests:t="The number of parallel requests exceeded the number of allowed concurrent transcriptions."}return t}}class wt{constructor(e,t,i){this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}class Rt{constructor(e,t,i,r,n,s,o,a,c,h){this.privResultId=e,this.privReason=t,this.privText=i,this.privDuration=r,this.privOffset=n,this.privLanguage=s,this.privLanguageDetectionConfidence=o,this.privErrorDetails=a,this.privJson=c,this.privProperties=h}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}class It extends wt{constructor(e,t,i){super(e,t,i)}static fromResult(e){let t=oe.Error,i=ae.NoError;if(e instanceof Rt&&e.json){const i=gt.fromJSON(e.json);t=Ct.implTranslateCancelResult(i.RecognitionStatus)}return e.properties&&(i=ae[e.properties.getProperty(Qe,ae[ae.NoError])]),new It(t,e.errorDetails||Ct.implTranslateErrorDetails(i),i)}}class Pt{constructor(e){const t=JSON.parse(e);ie.throwIfNullOrUndefined(t.NBest[0],"NBest"),this.privPronJson=t.NBest[0]}static fromResult(e){ie.throwIfNullOrUndefined(e,"result");const t=e.properties.getProperty(r.SpeechServiceResponse_JsonResult);return ie.throwIfNullOrUndefined(t,"json"),new Pt(t)}get detailResult(){return this.privPronJson}get accuracyScore(){return this.detailResult.PronunciationAssessment.AccuracyScore}get pronunciationScore(){return this.detailResult.PronunciationAssessment.PronScore}get completenessScore(){return this.detailResult.PronunciationAssessment.CompletenessScore}get fluencyScore(){return this.detailResult.PronunciationAssessment.FluencyScore}}!function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(ut||(ut={})),function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(dt||(dt={}));class bt{constructor(){}static fromSubscription(e,t){ie.throwIfNullOrWhitespace(e,"subscriptionKey"),ie.throwIfNullOrWhitespace(t,"region");const i=new Et;return i.setProperty(r.SpeechServiceConnection_Region,t),i.setProperty(r.SpeechServiceConnection_IntentRegion,t),i.setProperty(r.SpeechServiceConnection_Key,e),i}static fromEndpoint(e,t){ie.throwIfNull(e,"endpoint");const i=new Et;return i.setProperty(r.SpeechServiceConnection_Endpoint,e.href),void 0!==t&&i.setProperty(r.SpeechServiceConnection_Key,t),i}static fromHost(e,t){ie.throwIfNull(e,"hostName");const i=new Et;return i.setProperty(r.SpeechServiceConnection_Host,e.protocol+"//"+e.hostname+(""===e.port?"":":"+e.port)),void 0!==t&&i.setProperty(r.SpeechServiceConnection_Key,t),i}static fromAuthorizationToken(e,t){ie.throwIfNull(e,"authorizationToken"),ie.throwIfNullOrWhitespace(t,"region");const i=new Et;return i.setProperty(r.SpeechServiceConnection_Region,t),i.setProperty(r.SpeechServiceConnection_IntentRegion,t),i.authorizationToken=e,i}close(){}}class Et extends bt{constructor(){super(),this.privProperties=new Me,this.speechRecognitionLanguage="en-US",this.outputFormat=ut.Simple}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(r.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(r.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(r.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(r.SpeechServiceAuthorization_Token)}set authorizationToken(e){this.privProperties.setProperty(r.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return this.privProperties.getProperty(r.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(e){this.privProperties.setProperty(r.SpeechServiceConnection_RecoLanguage,e)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(r.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(e){this.privProperties.setProperty(r.SpeechServiceConnection_AutoDetectSourceLanguages,e)}get outputFormat(){return ut[this.privProperties.getProperty(Ge,void 0)]}set outputFormat(e){this.privProperties.setProperty(Ge,ut[e])}get endpointId(){return this.privProperties.getProperty(r.SpeechServiceConnection_EndpointId)}set endpointId(e){this.privProperties.setProperty(r.SpeechServiceConnection_EndpointId,e)}setProperty(e,t){ie.throwIfNull(t,"value"),this.privProperties.setProperty(e,t)}getProperty(e,t){return this.privProperties.getProperty(e,t)}setProxy(e,t,i,n){this.setProperty(r[r.SpeechServiceConnection_ProxyHostName],e),this.setProperty(r[r.SpeechServiceConnection_ProxyPort],t),this.setProperty(r[r.SpeechServiceConnection_ProxyUserName],i),this.setProperty(r[r.SpeechServiceConnection_ProxyPassword],n)}setServiceProperty(e,t){const i=JSON.parse(this.privProperties.getProperty(Xe,"{}"));i[e]=t,this.privProperties.setProperty(Xe,JSON.stringify(i))}setProfanity(e){this.privProperties.setProperty(r.SpeechServiceResponse_ProfanityOption,dt[e])}enableAudioLogging(){this.privProperties.setProperty(r.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(r.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privProperties.setProperty(Ze,"true")}clone(){const e=new Et;return e.privProperties=this.privProperties.clone(),e}get speechSynthesisLanguage(){return this.privProperties.getProperty(r.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(e){this.privProperties.setProperty(r.SpeechServiceConnection_SynthLanguage,e)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(r.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(e){this.privProperties.setProperty(r.SpeechServiceConnection_SynthVoice,e)}get speechSynthesisOutputFormat(){return he[this.privProperties.getProperty(r.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(e){this.privProperties.setProperty(r.SpeechServiceConnection_SynthOutputFormat,he[e])}}var At=i(137),Tt=i.n(At);class Mt{constructor(e,t){this.privStatusCode=e,this.privReason=t}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}class Dt{constructor(e,t,i){if(this.privPayload=null,!t)throw new R("payload");if(e===ne.Binary&&"ArrayBuffer"!==t.__proto__.constructor.name)throw new I("Payload must be ArrayBuffer");if(e===ne.Text&&"string"!=typeof t)throw new I("Payload must be a string");this.privMessageType=e,this.privPayload=t,this.privId=i||w()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===ne.Binary)throw new I("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===ne.Text)throw new I("Not supported for text message");return this.privPayload}get id(){return this.privId}}var Ot=i(173),zt=i(339);class kt extends O{constructor(e,t,i){super(e,t),this.privSignature=i}}class xt extends kt{constructor(e){super("OCSPMemoryCacheHitEvent",A.Debug,e)}}class Bt extends kt{constructor(e){super("OCSPCacheMissEvent",A.Debug,e)}}class Lt extends kt{constructor(e){super("OCSPDiskCacheHitEvent",A.Debug,e)}}class Nt extends kt{constructor(e){super("OCSPCacheUpdateNeededEvent",A.Debug,e)}}class _t extends kt{constructor(e){super("OCSPMemoryCacheStoreEvent",A.Debug,e)}}class Ft extends kt{constructor(e){super("OCSPDiskCacheStoreEvent",A.Debug,e)}}class qt extends kt{constructor(e){super("OCSPCacheUpdateCompleteEvent",A.Debug,e)}}class Kt extends kt{constructor(){super("OCSPStapleReceivedEvent",A.Debug,"")}}class Ut extends kt{constructor(e,t){super("OCSPCacheEntryExpiredEvent",A.Debug,e),this.privExpireTime=t}}class Ht extends kt{constructor(e,t,i){super("OCSPCacheEntryNeedsRefreshEvent",A.Debug,e),this.privExpireTime=i,this.privStartTime=t}}class Wt extends kt{constructor(e,t,i){super("OCSPCacheHitEvent",A.Debug,e),this.privExpireTime=i,this.privExpireTimeString=new Date(i).toLocaleDateString(),this.privStartTime=t,this.privStartTimeString=new Date(t).toLocaleTimeString()}}class Vt extends kt{constructor(e,t){super("OCSPVerificationFailedEvent",A.Debug,e),this.privError=t}}class jt extends kt{constructor(e,t){super("OCSPCacheFetchErrorEvent",A.Debug,e),this.privError=t}}class Jt extends kt{constructor(e){super("OCSPResponseRetrievedEvent",A.Debug,e)}}class $t extends kt{constructor(e,t){super("OCSPCacheUpdateErrorEvent",A.Debug,e),this.privError=t}}var Gt=i(108),Qt=i.n(Gt),Xt=i(275),Zt=i.n(Xt),Yt=i(505),ei=i.n(Yt),ti=i(146),ii=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class ri{constructor(e){e&&(this.privProxyInfo=e),ri.privDiskCache||(ri.privDiskCache=new(Zt())("microsoft-cognitiveservices-speech-sdk-cache",{supportBuffer:!0,location:"undefined"!=typeof process&&process.env.SPEECH_OCSP_CACHE_ROOT?process.env.SPEECH_OCSP_CACHE_ROOT:void 0}))}static forceReinitDiskCache(){ri.privDiskCache=void 0,ri.privMemCache={}}GetAgent(e){const t=new(Qt().Agent)(this.CreateConnection);return void 0!==this.privProxyInfo&&void 0!==this.privProxyInfo.HostName&&this.privProxyInfo.Port>0&&(t.privProxyInfo=this.privProxyInfo),t}static GetProxyAgent(e){const t={host:e.HostName,port:e.Port};return e.UserName?t.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${void 0===e.Password?"":e.Password}`).toString("base64")}:t.headers={},t.headers.requestOCSP="true",new(ei())(t)}static OCSPCheck(e,t){return ii(this,void 0,void 0,(function*(){let i,r,n=!1;const s=yield e;s.cork();const o=s;return new Promise(((e,a)=>{s.on("OCSPResponse",(e=>{e&&(this.onEvent(new Kt),r=e)})),s.on("error",(e=>{n||(n=!0,s.destroy(),a(e))})),o.on("secure",(()=>ii(this,void 0,void 0,(function*(){const c=o.getPeerCertificate(!0);try{const o=yield this.GetIssuer(c);i=zt.request.generate(c.raw,o.raw);const a=i.id.toString("hex");if(!r){const e=yield ri.GetResponseFromCache(a,i,t);r=e}yield this.VerifyOCSPResponse(r,i,t),s.uncork(),n=!0,e(s)}catch(e){s.destroy(),n=!0,a(e)}}))))}))}))}static GetIssuer(e){return e.issuerCertificate?Promise.resolve(e.issuerCertificate):new Promise(((t,i)=>{new zt.Agent({}).fetchIssuer(e,null,((e,r)=>{e?i(e):t(r)}))}))}static GetResponseFromCache(e,t,i){return ii(this,void 0,void 0,(function*(){let r=ri.privMemCache[e];if(r&&this.onEvent(new xt(e)),!r)try{const t=yield ri.privDiskCache.get(e);t.isCached&&(ri.onEvent(new Lt(e)),ri.StoreMemoryCacheEntry(e,t.value),r=t.value)}catch(e){r=null}if(!r)return r;try{const n=zt.utils.parseResponse(r).value.tbsResponseData;if(n.responses.length<1)return void this.onEvent(new jt(e,"Not enough data in cached response"));const s=n.responses[0].thisUpdate,o=n.responses[0].nextUpdate;if(o<Date.now()+this.testTimeOffset-6e4)this.onEvent(new Ut(e,o)),r=null;else{const r=Math.min(864e5,(o-s)/2);o-(Date.now()+this.testTimeOffset)<r?(this.onEvent(new Ht(e,s,o)),this.UpdateCache(t,i).catch((t=>{this.onEvent(new $t(e,t.toString()))}))):this.onEvent(new Wt(e,s,o))}}catch(t){this.onEvent(new jt(e,t)),r=null}return r||this.onEvent(new Bt(e)),r}))}static VerifyOCSPResponse(e,t,i){return ii(this,void 0,void 0,(function*(){let r=e;return r||(r=yield ri.GetOCSPResponse(t,i)),new Promise(((n,s)=>{zt.verify({request:t,response:r},(o=>{o?(ri.onEvent(new Vt(t.id.toString("hex"),o)),e?this.VerifyOCSPResponse(null,t,i).then((()=>{n()}),(e=>{s(e)})):s(o)):(e||ri.StoreCacheEntry(t.id.toString("hex"),r),n())}))}))}))}static UpdateCache(e,t){return ii(this,void 0,void 0,(function*(){const i=e.id.toString("hex");this.onEvent(new Nt(i));const r=yield this.GetOCSPResponse(e,t);this.StoreCacheEntry(i,r),this.onEvent(new qt(e.id.toString("hex")))}))}static StoreCacheEntry(e,t){this.StoreMemoryCacheEntry(e,t),this.StoreDiskCacheEntry(e,t)}static StoreMemoryCacheEntry(e,t){this.privMemCache[e]=t,this.onEvent(new _t(e))}static StoreDiskCacheEntry(e,t){this.privDiskCache.set(e,t).then((()=>{this.onEvent(new Ft(e))}))}static GetOCSPResponse(e,t){let i={};if(t){const e=ri.GetProxyAgent(t);i.agent=e}return new Promise(((t,r)=>{zt.utils.getAuthorityInfo(e.cert,"1.3.6.1.5.5.7.48.1",((n,s)=>{if(n)return void r(n);const o=new URL(s);i=Object.assign(Object.assign({},i),{host:o.host,protocol:o.protocol,port:o.port,path:o.pathname,hostname:o.host}),zt.utils.getResponse(i,e.data,((i,n)=>{if(i)return void r(i);const s=e.certID;this.onEvent(new Jt(s.toString("hex"))),t(n)}))}))}))}static onEvent(e){G.instance.onEvent(e)}CreateConnection(e,t){const i="undefined"!=typeof process&&"0"!==process.env.NODE_TLS_REJECT_UNAUTHORIZED&&"0"!==process.env.SPEECH_CONDUCT_OCSP_CHECK&&t.secureEndpoint;let r;if(t=Object.assign(Object.assign({},t),{requestOCSP:!ri.forceDisableOCSPStapling,servername:t.host}),this.privProxyInfo){const i=ri.GetProxyAgent(this.privProxyInfo);r=new Promise(((r,n)=>{i.callback(e,t,((e,t)=>{e?n(e):r(t)}))}))}else r=t.secureEndpoint?Promise.resolve(Ot.connect(t)):Promise.resolve(ti.connect(t));return i?ri.OCSPCheck(r,this.privProxyInfo):r}}ri.testTimeOffset=0,ri.forceDisableOCSPStapling=!1,ri.privMemCache={};var ni=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class si{constructor(e,t,i,r,n,s){if(!e)throw new R("uri");if(!i)throw new R("messageFormatter");this.proxyInfo=r,this.privConnectionEvents=new b,this.privConnectionId=t,this.privMessageFormatter=i,this.privConnectionState=se.None,this.privUri=e,this.privHeaders=n,this.privEnableCompression=s,this.privHeaders[Ye.ConnectionId]=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===se.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new M,this.privCertificateValidatedDeferral=new M,this.privConnectionState=se.Connecting;try{if("undefined"==typeof WebSocket||si.forceNpmWebSocket){const e={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression};this.privCertificateValidatedDeferral.resolve();const t=new ri(this.proxyInfo);e.agent=t.GetAgent();let i=new URL(this.privUri).protocol;"wss:"===(null==i?void 0:i.toLocaleLowerCase())?i="https:":"ws:"===(null==i?void 0:i.toLocaleLowerCase())&&(i="http:"),e.agent.protocol=i,this.privWebsocketClient=new(Tt())(this.privUri,e)}else this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new V,this.privDisconnectDeferral=new M,this.privSendMessageQueue=new V,this.processSendQueue().catch((e=>{G.instance.onEvent(new rt(e))}))}catch(e){return this.privConnectionEstablishDeferral.resolve(new Mt(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new ye(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then((()=>{this.privConnectionState=se.Connected,this.onEvent(new Ce(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new Mt(200,""))}),(e=>{this.privConnectionEstablishDeferral.reject(e)}))},this.privWebsocketClient.onerror=e=>{this.onEvent(new Re(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===se.Connecting?(this.privConnectionState=se.Disconnected,this.privConnectionEstablishDeferral.resolve(new Mt(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=se.Disconnected,this.privWebsocketClient=null,this.onEvent(new we(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch((e=>{G.instance.onEvent(new rt(e))}))},this.privWebsocketClient.onmessage=e=>{const t=(new Date).toISOString();if(this.privConnectionState===se.Connected){const i=new M;if(this.privReceivingMessageQueue.enqueueFromPromise(i.promise),e.data instanceof ArrayBuffer){const r=new Dt(ne.Binary,e.data);this.privMessageFormatter.toConnectionMessage(r).then((e=>{this.onEvent(new Pe(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject(`Invalid binary message format. Error: ${e}`)}))}else{const r=new Dt(ne.Text,e.data);this.privMessageFormatter.toConnectionMessage(r).then((e=>{this.onEvent(new Pe(this.privConnectionId,t,e)),i.resolve(e)}),(e=>{i.reject(`Invalid text message format. Error: ${e}`)}))}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==se.Connected)return Promise.reject(`Cannot send on connection that is in ${se[this.privConnectionState]} state`);const t=new M,i=new M;return this.privSendMessageQueue.enqueueFromPromise(i.promise),this.privMessageFormatter.fromConnectionMessage(e).then((r=>{i.resolve({Message:e,RawWebsocketMessage:r,sendStatusDeferral:t})}),(e=>{i.reject(`Error formatting the message. ${e}`)})),t.promise}read(){return this.privConnectionState!==se.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){return this.privWebsocketClient?(this.privConnectionState!==se.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client"),this.privDisconnectDeferral.promise):Promise.resolve()}get events(){return this.privConnectionEvents}sendRawMessage(e){try{return e?(this.onEvent(new be(this.privConnectionId,(new Date).toISOString(),e.Message)),this.isWebsocketOpen?(this.privWebsocketClient.send(e.RawWebsocketMessage.payload),Promise.resolve()):Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+(new Error).stack)):Promise.resolve()}catch(e){return Promise.reject(`websocket send error: ${e}`)}}onClose(e,t){return ni(this,void 0,void 0,(function*(){const i=`Connection closed. ${e}: ${t}`;this.privConnectionState=se.Disconnected,this.privDisconnectDeferral.resolve(),yield this.privReceivingMessageQueue.drainAndDispose((()=>{}),i),yield this.privSendMessageQueue.drainAndDispose((e=>{e.sendStatusDeferral.reject(i)}),i)}))}processSendQueue(){return ni(this,void 0,void 0,(function*(){for(;;){const e=this.privSendMessageQueue.dequeue(),t=yield e;if(!t)return;try{yield this.sendRawMessage(t),t.sendStatusDeferral.resolve()}catch(e){t.sendStatusDeferral.reject(e)}}}))}onEvent(e){this.privConnectionEvents.onEvent(e),G.instance.onEvent(e)}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}si.forceNpmWebSocket=!1;var oi;class ai{constructor(e,t,i,r,n,s=!1,o){if(this.privIsDisposed=!1,!e)throw new R("uri");if(!r)throw new R("messageFormatter");this.privMessageFormatter=r;let a="",c=0;if(t)for(const i in t)if(i){a+=0===c&&-1===e.indexOf("?")?"?":"&",a+=encodeURIComponent(i);let r=t[i];r&&(r=encodeURIComponent(r),a+=`=${r}`),c++}if(i)for(const t in i)t&&(a+=0===c&&-1===e.indexOf("?")?"?":"&",a+=`${t}=${encodeURIComponent(i[t])}`,c++);this.privUri=e+a,this.privId=o||w(),this.privConnectionMessageAdapter=new si(this.privUri,this.id,this.privMessageFormatter,n,i,s)}dispose(){return e=this,t=void 0,r=function*(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&(yield this.privConnectionMessageAdapter.close())},new((i=void 0)||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}));var e,t,i,r}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}class ci{constructor(e,t,i,r){this.privProxyHostName=e,this.privProxyPort=t,this.privProxyUserName=i,this.privProxyPassword=r}static fromParameters(e){return new ci(e.getProperty(r.SpeechServiceConnection_ProxyHostName),parseInt(e.getProperty(r.SpeechServiceConnection_ProxyPort),10),e.getProperty(r.SpeechServiceConnection_ProxyUserName),e.getProperty(r.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(e){return this.fromParameters(e.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}}class hi{}hi.BotId="botid",hi.CustomSpeechDeploymentId="cid",hi.CustomVoiceDeploymentId="deploymentId",hi.EnableAudioLogging="storeAudio",hi.EnableLanguageId="lidEnabled",hi.EnableWordLevelTimestamps="wordLevelTimestamps",hi.EndSilenceTimeoutMs="endSilenceTimeoutMs",hi.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs",hi.Format="format",hi.InitialSilenceTimeoutMs="initialSilenceTimeoutMs",hi.Language="language",hi.Profanity="profanity",hi.RequestBotStatusMessages="enableBotMessageStatus",hi.StableIntermediateThreshold="stableIntermediateThreshold",hi.StableTranslation="stableTranslation",hi.TestHooks="testhooks",hi.Postprocessing="postprocessing",hi.CtsMeetingId="meetingId",hi.CtsDeviceId="deviceId",hi.CtsIsParticipant="isParticipant";class pi{static getHostSuffix(e){if(e){if(e.toLowerCase().startsWith("china"))return".azure.cn";if(e.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(e,t,i){new Map([[r.Speech_SegmentationSilenceTimeoutMs,hi.SegmentationSilenceTimeoutMs],[r.SpeechServiceConnection_EnableAudioLogging,hi.EnableAudioLogging],[r.SpeechServiceConnection_EndSilenceTimeoutMs,hi.EndSilenceTimeoutMs],[r.SpeechServiceConnection_InitialSilenceTimeoutMs,hi.InitialSilenceTimeoutMs],[r.SpeechServiceResponse_PostProcessingOption,hi.Postprocessing],[r.SpeechServiceResponse_ProfanityOption,hi.Profanity],[r.SpeechServiceResponse_RequestWordLevelTimestamps,hi.EnableWordLevelTimestamps],[r.SpeechServiceResponse_StablePartialResultThreshold,hi.StableIntermediateThreshold]]).forEach(((r,n)=>{this.setUrlParameter(n,r,e,t,i)}));const n=JSON.parse(e.parameters.getProperty(Xe,"{}"));Object.keys(n).forEach((e=>{t[e]=n[e]}))}setUrlParameter(e,t,i,r,n){const s=i.parameters.getProperty(e,void 0);!s||n&&-1!==n.search(t)||(r[t]=s.toLocaleLowerCase())}}class ui{toConnectionMessage(e){const t=new M;try{if(e.messageType===ne.Text){const i=e.textContent;let r={},n=null;if(i){const e=i.split("\r\n\r\n");e&&e.length>0&&(r=this.parseHeaders(e[0]),e.length>1&&(n=e[1]))}t.resolve(new Se(e.messageType,n,r,e.id))}else if(e.messageType===ne.Binary){const i=e.binaryContent;let r={},n=null;if(!i||i.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const s=new DataView(i),o=s.getInt16(0);if(i.byteLength<o+2)throw new Error("Invalid binary message format. Header content missing.");let a="";for(let e=0;e<o;e++)a+=String.fromCharCode(s.getInt8(e+2));r=this.parseHeaders(a),i.byteLength>o+2&&(n=i.slice(2+o)),t.resolve(new Se(e.messageType,n,r,e.id))}}catch(e){t.reject(`Error formatting the message. Error: ${e}`)}return t.promise}fromConnectionMessage(e){const t=new M;try{if(e.messageType===ne.Text){const i=`${this.makeHeaders(e)}\r\n${e.textBody?e.textBody:""}`;t.resolve(new Dt(ne.Text,i,e.id))}else if(e.messageType===ne.Binary){const i=this.makeHeaders(e),r=e.binaryBody,n=this.stringToArrayBuffer(i),s=new Int8Array(n),o=s.byteLength,a=new Int8Array(2+o+(r?r.byteLength:0));if(a[0]=o>>8&255,a[1]=255&o,a.set(s,2),r){const e=new Int8Array(r);a.set(e,2+o)}const c=a.buffer;t.resolve(new Dt(ne.Binary,c,e.id))}}catch(e){t.reject(`Error formatting the message. ${e}`)}return t.promise}makeHeaders(e){let t="";if(e.headers)for(const i in e.headers)i&&(t+=`${i}: ${e.headers[i]}\r\n`);return t}parseHeaders(e){const t={};if(e){const i=e.match(/[^\r\n]+/g);if(t)for(const e of i)if(e){const i=e.indexOf(":"),r=i>0?e.substr(0,i).trim().toLowerCase():e,n=i>0&&e.length>i+1?e.substr(i+1).trim():"";t[r]=n}}return t}stringToArrayBuffer(e){const t=new ArrayBuffer(e.length),i=new DataView(t);for(let t=0;t<e.length;t++)i.setUint8(t,e.charCodeAt(t));return t}}class di extends pi{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/speech/universal/v"}create(e,t,i){let s=e.parameters.getProperty(r.SpeechServiceConnection_Endpoint,void 0);const o=e.parameters.getProperty(r.SpeechServiceConnection_Region,void 0),a=pi.getHostSuffix(o),c=e.parameters.getProperty(r.SpeechServiceConnection_Host,"wss://"+o+".stt.speech"+a),h={},p=e.parameters.getProperty(r.SpeechServiceConnection_EndpointId,void 0),u=e.parameters.getProperty(r.SpeechServiceConnection_RecoLanguage,void 0);if(p?s&&-1!==s.search(hi.CustomSpeechDeploymentId)||(h[hi.CustomSpeechDeploymentId]=p):u&&(s&&-1!==s.search(hi.Language)||(h[hi.Language]=u)),s&&-1!==s.search(hi.Format)||(h[hi.Format]=e.parameters.getProperty(Ge,ut[ut.Simple]).toLowerCase()),void 0!==e.autoDetectSourceLanguages&&(h[hi.EnableLanguageId]="true"),this.setCommonUrlParams(e,h,s),!s)switch(e.recognitionMode){case n.Conversation:s="true"===e.parameters.getProperty(Ze,"false")?c+this.dictationRelativeUri:void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${c}${this.universalUri}${e.recognitionEndpointVersion}`:c+this.conversationRelativeUri;break;case n.Dictation:s=c+this.dictationRelativeUri;break;default:s=void 0!==e.recognitionEndpointVersion&&parseInt(e.recognitionEndpointVersion,10)>1?`${c}${this.universalUri}${e.recognitionEndpointVersion}`:c+this.interactiveRelativeUri}const d={};void 0!==t.token&&""!==t.token&&(d[t.headerName]=t.token),d[Ye.ConnectionId]=i;const v="true"===e.parameters.getProperty("SPEECH-EnableWebsocketCompression","false"),l=new ai(s,h,d,new ui,ci.fromRecognizerConfig(e),v,i),f=l.uri;return e.parameters.setProperty(r.SpeechServiceConnection_Url,f),l}}class vi extends Rt{constructor(e,t,i,r,n,s,o,a,c,h,p){super(e,t,i,r,n,s,o,c,h,p),this.privSpeakerId=a}get speakerId(){return this.privSpeakerId}}class li{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}class fi extends li{constructor(e,t){super(t),this.privOffset=e}get offset(){return this.privOffset}}class Si extends fi{constructor(e,t,i){super(t,i),this.privResult=e}get result(){return this.privResult}}class mi extends fi{constructor(e,t,i,r,n){super(r,n),this.privReason=e,this.privErrorDetails=t,this.privErrorCode=i}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}class gi extends mi{}class yi{constructor(e,t){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=t}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&0!==this.privBuffers.length){const e=this.privReplayOffset-this.privBufferStartOffset;let t=Math.round(e*this.privBytesPerSecond*1e-7);0!=t%2&&t++;let i=0;for(;i<this.privBuffers.length&&t>=this.privBuffers[i].chunk.buffer.byteLength;)t-=this.privBuffers[i++].chunk.buffer.byteLength;if(i<this.privBuffers.length){const e=this.privBuffers[i].chunk.buffer.slice(t);return this.privReplayOffset+=e.byteLength/this.privBytesPerSecond*1e7,i===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:e,isEnd:!1,timeReceived:this.privBuffers[i].chunk.timeReceived})}}return this.privAudioNode.read().then((e=>(e&&e.buffer&&(this.privBuffers.push(new Ci(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e)))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&0!==this.privBuffers.length&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(void 0===this.privBuffers||0===this.privBuffers.length)return;this.privLastShrinkOffset=e;const t=e-this.privBufferStartOffset;let i=Math.round(t*this.privBytesPerSecond*1e-7),r=0;for(;r<this.privBuffers.length&&i>=this.privBuffers[r].chunk.buffer.byteLength;)i-=this.privBuffers[r++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-i/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(r)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||void 0===this.privBuffers)return 0;for(const t of this.privBuffers){const i=t.byteOffset/this.privBytesPerSecond*1e7,r=i+t.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=i&&e<=r)return t.chunk.timeReceived}return 0}}class Ci{constructor(e,t,i){this.chunk=e,this.serial=t,this.byteOffset=i}}class wi{static load(){const e=new Map([[0,()=>{}]]),t=new Map,i="data:text/javascript;base64,"+btoa('!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error(\'There is no interval scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error(\'The given method "\'.concat(e.method,\'" is not supported\'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);'),r=new Worker(i);return r.addEventListener("message",(({data:i})=>{if(wi.isCallNotification(i)){const{params:{timerId:r}}=i,n=e.get(r);if("number"==typeof n){const e=t.get(n);if(void 0===e||e!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===n)throw new Error("The timer is in an undefined state.");n(),e.delete(r)}}else{if(!wi.isClearResponse(i)){const{error:{message:e}}=i;throw new Error(e)}{const{id:r}=i,n=t.get(r);if(void 0===n)throw new Error("The timer is in an undefined state.");t.delete(r),e.delete(n)}}})),{clearTimeout:i=>{const n=Math.random();t.set(n,i),e.set(i,n),r.postMessage({id:n,method:"clear",params:{timerId:i}})},setTimeout:(t,i)=>{const n=Math.random();return e.set(n,t),r.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:n}}),n}}}static loadWorkerTimers(){return()=>(null!==wi.workerTimers||(wi.workerTimers=wi.load()),wi.workerTimers)}static isCallNotification(e){return void 0!==e.method&&"call"===e.method}static isClearResponse(e){return null===e.error&&"number"==typeof e.id}}wi.workerTimers=null,wi.clearTimeout=e=>wi.timers().clearTimeout(e),wi.setTimeout=(e,t)=>wi.timers().setTimeout(e,t),wi.timers=wi.loadWorkerTimers();class Ri extends O{constructor(e,t,i,r=A.Info){super(e,r),this.privRequestId=t,this.privSessionId=i}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}class Ii extends Ri{constructor(e,t,i,r){super("RecognitionTriggeredEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class Pi extends Ri{constructor(e,t,i,r){super("ListeningStartedEvent",e,t),this.privAudioSourceId=i,this.privAudioNodeId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}class bi extends Ri{constructor(e,t,i){super("ConnectingToServiceEvent",e,i),this.privAuthFetchEventid=t}get authFetchEventid(){return this.privAuthFetchEventid}}class Ei extends Ri{constructor(e,t,i,r,n){super("RecognitionStartedEvent",e,n),this.privAudioSourceId=t,this.privAudioNodeId=i,this.privAuthFetchEventId=r}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}!function(e){e[e.Success=0]="Success",e[e.AudioSourceError=1]="AudioSourceError",e[e.AudioSourceTimeout=2]="AudioSourceTimeout",e[e.AuthTokenFetchError=3]="AuthTokenFetchError",e[e.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",e[e.UnAuthorized=5]="UnAuthorized",e[e.ConnectTimeout=6]="ConnectTimeout",e[e.ConnectError=7]="ConnectError",e[e.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",e[e.UnknownError=9]="UnknownError"}(oi||(oi={}));class Ai{constructor(e,t,i){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=t,this.privAudioNodeId=i,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){if(!this.privIsDisposed&&(e instanceof Ii&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof _&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof F&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof L&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof K&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof q&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof bi&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof ye&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof Ce&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof Ie&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof Pe&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path)){this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array);const t=50;this.privReceivedMessages[e.message.headers.path].length<t&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)}}getTelemetry(){const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const t={Metrics:e,ReceivedMessages:this.privReceivedMessages},i=JSON.stringify(t);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],i}get hasTelemetry(){return 0!==Object.keys(this.privReceivedMessages).length||null!==this.privListeningTriggerMetric||null!==this.privMicMetric||null!==this.privConnectionEstablishMetric||0!==this.privPhraseLatencies.length||0!==this.privHypothesisLatencies.length}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}}var Ti=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class Mi{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=w(),this.privAudioNodeId=w(),this.privTurnDeferral=new M,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new Ai(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new Ii(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onAudioSourceAttachCompleted(e,t){return Ti(this,void 0,void 0,(function*(){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,t?yield this.onComplete():this.onEvent(new Pi(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}))}onPreConnectionStart(e,t){this.privAuthFetchEventId=e,this.privSessionId=t,this.onEvent(new bi(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}onAuthCompleted(e){return Ti(this,void 0,void 0,(function*(){e&&(yield this.onComplete())}))}onConnectionEstablishCompleted(e,t){return Ti(this,void 0,void 0,(function*(){if(200===e)return this.onEvent(new Ei(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,void(this.privBytesSent=0);403===e&&(yield this.onComplete())}))}onServiceTurnEndResponse(e){return Ti(this,void 0,void 0,(function*(){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(yield this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}))}onSpeechContext(){this.privRequestId=w()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch((()=>{}))),this.privInTurn=!0,this.privTurnDeferral=new M}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}dispose(){return Ti(this,void 0,void 0,(function*(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)yield e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}))}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}onStopRecognizing(){return Ti(this,void 0,void 0,(function*(){yield this.onComplete()}))}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),G.instance.onEvent(e)}onComplete(){return Ti(this,void 0,void 0,(function*(){this.privIsRecognizing&&(this.privIsRecognizing=!1,yield this.detachAudioNode())}))}detachAudioNode(){return Ti(this,void 0,void 0,(function*(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&(yield this.privAudioNode.detach()))}))}}class Di{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(void 0===this.privGrammars&&void 0===this.privPhrases)return;const e={};if(e.ReferenceGrammars=this.privGrammars,void 0!==this.privPhrases&&0!==this.privPhrases.length){const t=[];this.privPhrases.forEach((e=>{t.push({Text:e})})),e.Groups=[{Type:"Generic",Items:t}]}return e}}class Oi{constructor(e){this.privContext={},this.privDynamicGrammar=e}setSection(e,t){this.privContext[e]=t}setPronunciationAssessmentParams(e){void 0===this.privContext.phraseDetection&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push("PronunciationAssessment"),-1===this.privContext.phraseOutput.detailed.options.indexOf("SNR")&&this.privContext.phraseOutput.detailed.options.push("SNR")}setWordLevelTimings(){void 0===this.privContext.phraseOutput&&(this.privContext.phraseOutput={detailed:{options:[]},format:{}}),void 0===this.privContext.phraseOutput.detailed&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format="Detailed",-1===this.privContext.phraseOutput.detailed.options.indexOf("WordTimings")&&this.privContext.phraseOutput.detailed.options.push("WordTimings")}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.setSection("dgi",e),JSON.stringify(this.privContext)}}class zi{constructor(e){this.privSpeechStartDetected=JSON.parse(e)}static fromJSON(e){return new zi(e)}get Offset(){return this.privSpeechStartDetected.Offset}}var ki=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class xi{constructor(e,t,i,r,n){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.recognizeOverride=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!e)throw new R("authentication");if(!t)throw new R("connectionFactory");if(!i)throw new R("audioSource");if(!r)throw new R("recognizerConfig");this.privMustReportEndOfStream=!1,this.privAuthentication=e,this.privConnectionFactory=t,this.privAudioSource=i,this.privRecognizerConfig=r,this.privIsDisposed=!1,this.privRecognizer=n,this.privRequestSession=new Mi(this.privAudioSource.id()),this.privConnectionEvents=new b,this.privServiceEvents=new b,this.privDynamicGrammar=new Di,this.privSpeechContext=new Oi(this.privDynamicGrammar),this.privAgentConfig=new $e,"undefined"!=typeof Blob&&"undefined"!=typeof Worker&&(this.privSetTimeout=wi.setTimeout),this.connectionEvents.attach((e=>{if("ConnectionClosedEvent"===e.name){const t=e;(1003===t.statusCode||1007===t.statusCode||1002===t.statusCode||4e3===t.statusCode||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(oe.Error,1007===t.statusCode?ae.BadRequestParameters:ae.ConnectionFailure,`${t.reason} websocket error code: ${t.statusCode}`)}}))}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(e){this.privRecognizerConfig.parameters.setProperty(r.ConversationTranslator_Token,e)}set authentication(e){this.privAuthentication=this.authentication}isDisposed(){return this.privIsDisposed}dispose(e){return ki(this,void 0,void 0,(function*(){if(this.privIsDisposed=!0,void 0!==this.privConnectionConfigurationPromise)try{const t=yield this.privConnectionConfigurationPromise;yield t.dispose(e)}catch(e){return}}))}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}recognize(e,t,i){return ki(this,void 0,void 0,(function*(){if(void 0!==this.recognizeOverride)return void(yield this.recognizeOverride(e,t,i));this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=e,this.privSuccessCallback=t,this.privErrorCallback=i,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const r=this.connectImpl();let n;try{const e=yield this.audioSource.attach(this.privRequestSession.audioNodeId),t=yield this.audioSource.format,i=yield this.audioSource.deviceInfo;this.privIsLiveAudio=i.type&&i.type===a.Microphones,n=new yi(e,t.avgBytesPerSec),yield this.privRequestSession.onAudioSourceAttachCompleted(n,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:i}}catch(e){throw yield this.privRequestSession.onStopRecognizing(),e}try{yield r}catch(e){return void(yield this.cancelRecognitionLocal(oe.Error,ae.ConnectionFailure,e))}const s=new li(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,s),this.receiveMessage(),this.sendAudio(n).catch((e=>ki(this,void 0,void 0,(function*(){yield this.cancelRecognitionLocal(oe.Error,ae.RuntimeError,e)}))))}))}stopRecognizing(){return ki(this,void 0,void 0,(function*(){if(this.privRequestSession.isRecognizing)try{yield this.audioSource.turnOff(),yield this.sendFinalAudio(),yield this.privRequestSession.onStopRecognizing(),yield this.privRequestSession.turnCompletionPromise}finally{yield this.privRequestSession.dispose()}}))}connect(){return ki(this,void 0,void 0,(function*(){return yield this.connectImpl(),Promise.resolve()}))}connectAsync(e,t){this.connectImpl().then((()=>{try{e&&e()}catch(e){t&&t(e)}}),(e=>{try{t&&t(e)}catch(e){}}))}disconnect(){return ki(this,void 0,void 0,(function*(){if(yield this.cancelRecognitionLocal(oe.Error,ae.NoError,"Disconnecting"),void 0!==this.disconnectOverride&&(yield this.disconnectOverride()),void 0!==this.privConnectionPromise)try{yield(yield this.privConnectionPromise).dispose()}catch(e){}this.privConnectionPromise=void 0}))}sendMessage(e){}sendNetworkMessage(e,t){return ki(this,void 0,void 0,(function*(){const i="string"==typeof t?ne.Text:ne.Binary,r="string"==typeof t?"application/json":"";return(yield this.fetchConnection()).send(new et(i,e,this.privRequestSession.requestId,r,t))}))}set activityTemplate(e){this.privActivityTemplate=e}get activityTemplate(){return this.privActivityTemplate}sendTelemetryData(){return ki(this,void 0,void 0,(function*(){const e=this.privRequestSession.getTelemetry();if(!0!==xi.telemetryDataEnabled||this.privIsDisposed||null===e)return;if(xi.telemetryData)try{xi.telemetryData(e)}catch(e){}const t=yield this.fetchConnection();yield t.send(new et(ne.Text,"telemetry",this.privRequestSession.requestId,"application/json",e))}))}cancelRecognitionLocal(e,t,i){return ki(this,void 0,void 0,(function*(){this.privRequestSession.isRecognizing&&(yield this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,e,t,i))}))}receiveMessage(){return ki(this,void 0,void 0,(function*(){try{if(this.privIsDisposed)return;let e=yield this.fetchConnection();const t=yield e.read();if(void 0!==this.receiveMessageOverride)return this.receiveMessageOverride();if(!t)return this.privRequestSession.isRecognizing?this.receiveMessage():void 0;this.privServiceHasSentMessage=!0;const i=et.fromConnectionMessage(t);if(i.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(i.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const t=zi.fromJSON(i.textBody),r=new fi(t.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,r);break;case"speech.enddetected":let n;n=i.textBody.length>0?i.textBody:"{ Offset: 0 }";const s=zi.fromJSON(n);this.privRecognizerConfig.isContinuousRecognition&&this.privRequestSession.onServiceRecognized(s.Offset+this.privRequestSession.currentTurnAudioOffset);const o=new fi(s.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,o);break;case"turn.end":yield this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,yield this.cancelRecognitionLocal(oe.EndOfStream,ae.NoError,void 0));const a=new li(this.privRequestSession.sessionId);if(yield this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)return void(this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,a));e=yield this.fetchConnection(),yield this.sendPrePayloadJSON(e);break;default:(yield this.processTypeSpecificMessages(i))||this.privServiceEvents&&this.serviceEvents.onEvent(new me(i.path.toLowerCase(),i.textBody))}return this.receiveMessage()}catch(e){return null}}))}sendSpeechContext(e,t){const i=this.speechContext.toJSON();if(t&&this.privRequestSession.onSpeechContext(),i)return e.send(new et(ne.Text,"speech.context",this.privRequestSession.requestId,"application/json",i))}sendPrePayloadJSON(e,t=!0){return ki(this,void 0,void 0,(function*(){if(void 0!==this.sendPrePayloadJSONOverride)return this.sendPrePayloadJSONOverride(e);yield this.sendSpeechContext(e,t),yield this.sendWaveHeader(e)}))}sendWaveHeader(e){return ki(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;return e.send(new et(ne.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",t.header))}))}connectImpl(){return void 0!==this.privConnectionPromise?this.privConnectionPromise.then((e=>e.state()===se.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise),(()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()))):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch((()=>{})),void 0!==this.postConnectImplOverride?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(e,t,i){if(t.onSpeechContext(),!0!==xi.telemetryDataEnabled){const e={context:{system:JSON.parse(i).context.system}};i=JSON.stringify(e)}if("true"===this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()){const e=JSON.parse(i);e.context.DisableReferenceChannel="True",e.context.MicSpec="1_0_0",i=JSON.stringify(e)}if(i)return e.send(new et(ne.Text,"speech.config",t.requestId,"application/json",i))}fetchConnection(){return ki(this,void 0,void 0,(function*(){return void 0!==this.privConnectionConfigurationPromise?this.privConnectionConfigurationPromise.then((e=>e.state()===se.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise),(()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()))):(this.privConnectionConfigurationPromise=this.configureConnection(),yield this.privConnectionConfigurationPromise)}))}sendAudio(e){return ki(this,void 0,void 0,(function*(){const t=yield this.audioSource.format;let i=Date.now();const r=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),n=t.avgBytesPerSec/1e3*parseInt(r,10),s=this.privRequestSession.recogNumber,o=()=>ki(this,void 0,void 0,(function*(){if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===s){const r=yield this.fetchConnection(),a=yield e.read();if(this.privRequestSession.isSpeechEnded)return;let c,h;if(!a||a.isEnd?(c=null,h=0):(c=a.buffer,this.privRequestSession.onAudioSent(c.byteLength),h=n>=this.privRequestSession.bytesSent?0:Math.max(0,i-Date.now())),0!==h&&(yield this.delay(h)),null!==c&&(i=Date.now()+1e3*c.byteLength/(2*t.avgBytesPerSec)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===s){if(r.send(new et(ne.Binary,"audio",this.privRequestSession.requestId,null,c)).catch((()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch((()=>{}))})),!(null==a?void 0:a.isEnd))return o();this.privIsLiveAudio||this.privRequestSession.onSpeechEnded()}}}));return o()}))}retryableConnect(){return ki(this,void 0,void 0,(function*(){let e=!1;this.privAuthFetchEventId=w();const t=this.privRequestSession.sessionId;this.privConnectionId=void 0!==t?t:w(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let i=0,n="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){const t=e?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId),r=yield t;yield this.privRequestSession.onAuthCompleted(!1);const s=this.privConnectionFactory.create(this.privRecognizerConfig,r,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(s.events),s.events.attach((e=>{this.connectionEvents.onEvent(e)}));const o=yield s.open();if(200===o.statusCode)return yield this.privRequestSession.onConnectionEstablishCompleted(o.statusCode),Promise.resolve(s);1006===o.statusCode&&(e=!0),i=o.statusCode,n=o.reason,this.privRequestSession.onRetryConnection()}return yield this.privRequestSession.onConnectionEstablishCompleted(i,n),Promise.reject(`Unable to contact server. StatusCode: ${i}, ${this.privRecognizerConfig.parameters.getProperty(r.SpeechServiceConnection_Endpoint)} Reason: ${n}`)}))}delay(e){return new Promise((t=>this.privSetTimeout(t,e)))}writeBufferToConsole(e){let t="Buffer Size: ";if(null===e)t+="null";else{const i=new Uint8Array(e);t+=`${e.byteLength}\r\n`;for(let r=0;r<e.byteLength;r++)t+=i[r].toString(16).padStart(2,"0")+" ",(r+1)%16==0&&(console.info(t),t="")}console.info(t)}sendFinalAudio(){return ki(this,void 0,void 0,(function*(){const e=yield this.fetchConnection();yield e.send(new et(ne.Binary,"audio",this.privRequestSession.requestId,null,null))}))}configureConnection(){return ki(this,void 0,void 0,(function*(){const e=yield this.connectImpl();return void 0!==this.configConnectionOverride?this.configConnectionOverride(e):(yield this.sendSpeechServiceConfig(e,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),yield this.sendPrePayloadJSON(e,!1),e)}))}}xi.telemetryDataEnabled=!0;class Bi{constructor(e){this.privSpeechHypothesis=JSON.parse(e)}static fromJSON(e){return new Bi(e)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privSpeechHypothesis.PrimaryLanguage?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}class Li{constructor(e){this.privDetailedSpeechPhrase=JSON.parse(e),this.privDetailedSpeechPhrase.RecognitionStatus=ht[this.privDetailedSpeechPhrase.RecognitionStatus]}static fromJSON(e){return new Li(e)}getJsonWithCorrectedOffsets(e){if(this.privDetailedSpeechPhrase.NBest){let t;for(const e of this.privDetailedSpeechPhrase.NBest)if(e.Words&&e.Words[0]){t=e.Words[0].Offset;break}if(t&&t<e){const i=e-t;for(const e of this.privDetailedSpeechPhrase.NBest)if(e.Words)for(const t of e.Words)t.Offset+=i}}return JSON.stringify(this.privDetailedSpeechPhrase)}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return void 0===this.privDetailedSpeechPhrase.PrimaryLanguage?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}}class Ni extends xi{constructor(e,t,i,n,s){super(e,t,i,n,s),this.privSpeechRecognizer=s;const o={},a=n.parameters.getProperty(r.Speech_SegmentationSilenceTimeoutMs,void 0);if(void 0!==a){const e=parseInt(a,10);o.mode="INTERACTIVE",o.INTERACTIVE={segmentation:{mode:"Custom",segmentationSilenceTimeoutMs:e}}}if(void 0!==n.autoDetectSourceLanguages){const e=n.autoDetectSourceLanguages.split(",");let t;t="Continuous"===n.languageIdMode?"DetectContinuous":"DetectAtAudioStart",this.privSpeechContext.setSection("languageId",{Priority:"PrioritizeLatency",languages:e,mode:t,onSuccess:{action:"Recognize"},onUnknown:{action:"None"}}),this.privSpeechContext.setSection("phraseOutput",{interimResults:{resultType:"Auto"},phraseResults:{resultType:"Always"}});const i=n.sourceLanguageModels;void 0!==i&&(o.customModels=i,o.onInterim={action:"None"},o.onSuccess={action:"None"})}(e=>{for(const t in e)return!1;return!0})(o)||this.privSpeechContext.setSection("phraseDetection",o)}processTypeSpecificMessages(e){return t=this,i=void 0,s=function*(){let t;const i=new Me;i.setProperty(r.SpeechServiceResponse_JsonResult,e.textBody);let n=!1;switch(e.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const r=Bi.fromJSON(e.textBody),s=r.Offset+this.privRequestSession.currentTurnAudioOffset;t=new vi(this.privRequestSession.requestId,ce.RecognizingSpeech,r.Text,r.Duration,s,r.Language,r.LanguageDetectionConfidence,void 0,void 0,e.textBody,i),this.privRequestSession.onHypothesis(s);const o=new Si(t,r.Duration,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,o)}catch(e){}n=!0;break;case"speech.phrase":const a=gt.fromJSON(e.textBody),c=Ct.implTranslateRecognitionResult(a.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(this.privRequestSession.currentTurnAudioOffset+a.Offset+a.Duration),ce.Canceled===c){const e=Ct.implTranslateCancelResult(a.RecognitionStatus),t=Ct.implTranslateCancelErrorCode(a.RecognitionStatus);yield this.cancelRecognitionLocal(e,t,Ct.implTranslateErrorDetails(t))}else{if(!this.privRequestSession.isSpeechEnded||c!==ce.NoMatch||a.RecognitionStatus===ht.InitialSilenceTimeout){if(this.privRecognizerConfig.parameters.getProperty(Ge)===ut[ut.Simple])t=new vi(this.privRequestSession.requestId,c,a.DisplayText,a.Duration,a.Offset+this.privRequestSession.currentTurnAudioOffset,a.Language,a.LanguageDetectionConfidence,void 0,void 0,e.textBody,i);else{const r=Li.fromJSON(e.textBody),n=r.Offset+this.privRequestSession.currentTurnAudioOffset,s=r.getJsonWithCorrectedOffsets(n);t=new vi(this.privRequestSession.requestId,c,r.RecognitionStatus===ht.Success?r.NBest[0].Display:void 0,r.Duration,n,r.Language,r.LanguageDetectionConfidence,void 0,void 0,s,i)}const r=new Si(t,t.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,r)}catch(e){}}if(this.privSuccessCallback){try{this.privSuccessCallback(t)}catch(e){this.privErrorCallback&&this.privErrorCallback(e)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}n=!0}return n},new((n=void 0)||(n=Promise))((function(e,r){function o(e){try{c(s.next(e))}catch(e){r(e)}}function a(e){try{c(s.throw(e))}catch(e){r(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}c((s=s.apply(t,i||[])).next())}));var t,i,n,s}cancelRecognition(e,t,i,r,n){const s=new Me;if(s.setProperty(Qe,ae[r]),this.privSpeechRecognizer.canceled){const t=new gi(i,n,r,void 0,e);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,t)}catch(e){}}if(this.privSuccessCallback){const e=new vi(t,ce.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,s);try{this.privSuccessCallback(e),this.privSuccessCallback=void 0}catch(e){}}}}class _i{constructor(e,t){this.privHeaderName=e,this.privToken=t}get headerName(){return this.privHeaderName}get token(){return this.privToken}}class Fi{constructor(e){if(!e)throw new R("subscriptionKey");this.privAuthInfo=new _i(Ye.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}}class qi{constructor(e,t){if(!e)throw new R("fetchCallback");if(!t)throw new R("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=t}fetch(e){return this.privFetchCallback(e).then((e=>new _i(Ye.Authorization,void 0===e?void 0:qi.privTokenPrefix+e)))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then((e=>new _i(Ye.Authorization,void 0===e?void 0:qi.privTokenPrefix+e)))}}qi.privTokenPrefix="bearer ";var Ki=function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};class Ui{constructor(e,t,i){this.audioConfig=void 0!==e?e:ft.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=t.clone(),this.privConnectionFactory=i,this.implCommonRecognizerSetup()}close(e,t){ie.throwIfDisposed(this.privDisposed),D(this.dispose(!0),e,t)}get internalData(){return this.privReco}dispose(e){return Ki(this,void 0,void 0,(function*(){this.privDisposed||(this.privDisposed=!0,e&&this.privReco&&(yield this.privReco.audioSource.turnOff(),yield this.privReco.dispose()))}))}static get telemetryEnabled(){return xi.telemetryDataEnabled}static enableTelemetry(e){xi.telemetryDataEnabled=e}implCommonRecognizerSetup(){let e="undefined"!=typeof window?"Browser":"Node",t="unknown",i="unknown";"undefined"!=typeof navigator&&(e=e+"/"+navigator.platform,t=navigator.userAgent,i=navigator.appVersion);const r=this.createRecognizerConfig(new p(new u(new v(e,t,i))));this.privReco=this.createServiceRecognizer(Ui.getAuthFromProperties(this.privProperties),this.privConnectionFactory,this.audioConfig,r)}recognizeOnceAsyncImpl(e){return Ki(this,void 0,void 0,(function*(){ie.throwIfDisposed(this.privDisposed);const t=new M;yield this.implRecognizerStop(),yield this.privReco.recognize(e,t.resolve,t.reject);const i=yield t.promise;return yield this.implRecognizerStop(),i}))}startContinuousRecognitionAsyncImpl(e){return Ki(this,void 0,void 0,(function*(){ie.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop(),yield this.privReco.recognize(e,void 0,void 0)}))}stopContinuousRecognitionAsyncImpl(){return Ki(this,void 0,void 0,(function*(){ie.throwIfDisposed(this.privDisposed),yield this.implRecognizerStop()}))}implRecognizerStop(){return Ki(this,void 0,void 0,(function*(){this.privReco&&(yield this.privReco.stopRecognizing())}))}static getAuthFromProperties(e){const t=e.getProperty(r.SpeechServiceConnection_Key,void 0);return t&&""!==t?new Fi(t):new qi((()=>{const t=e.getProperty(r.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}),(()=>{const t=e.getProperty(r.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(t)}))}}class Hi extends Ui{constructor(e,t){const i=e;ie.throwIfNull(i,"speechConfig"),ie.throwIfNullOrWhitespace(i.properties.getProperty(r.SpeechServiceConnection_RecoLanguage),r[r.SpeechServiceConnection_RecoLanguage]),super(t,i.properties,new di),this.privDisposedRecognizer=!1}static FromConfig(e,t,i){const r=e;return t.properties.mergeTo(r.properties),new Hi(e,i)}get endpointId(){return ie.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(r.SpeechServiceAuthorization_Token)}set authorizationToken(e){ie.throwIfNullOrWhitespace(e,"token"),this.properties.setProperty(r.SpeechServiceAuthorization_Token,e)}get speechRecognitionLanguage(){return ie.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return ie.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(Ge,ut[ut.Simple])===ut[ut.Simple]?ut.Simple:ut.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(e,t){D(this.recognizeOnceAsyncImpl(n.Interactive),e,t)}startContinuousRecognitionAsync(e,t){D(this.startContinuousRecognitionAsyncImpl(n.Conversation),e,t)}stopContinuousRecognitionAsync(e,t){D(this.stopContinuousRecognitionAsyncImpl(),e,t)}startKeywordRecognitionAsync(e,t,i){ie.throwIfNull(e,"model"),i&&i("Not yet implemented.")}stopKeywordRecognitionAsync(e){e&&e()}close(e,t){ie.throwIfDisposed(this.privDisposedRecognizer),D(this.dispose(!0),e,t)}dispose(e){const t=Object.create(null,{dispose:{get:()=>super.dispose}});return i=this,r=void 0,s=function*(){this.privDisposedRecognizer||(e&&(this.privDisposedRecognizer=!0,yield this.implRecognizerStop()),yield t.dispose.call(this,e))},new((n=void 0)||(n=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}c((s=s.apply(i,r||[])).next())}));var i,r,n,s}createRecognizerConfig(e){return new h(e,this.properties)}createServiceRecognizer(e,t,i,r){return new Ni(e,t,i,r,this)}}var Wi=i(260),Vi=i.n(Wi),ji=i(76),Ji=i.n(ji);const $i="f037ba1b409b4530a95d6e638bfe8638",Gi="westeurope",Qi="cs-CZ",Xi=!1,Zi=document.createElement("div"),Yi=document.createElement("select");Yi.value="speechRecognizerRecognizeOnce";const er=[],tr=[],ir=document.createElement("button"),rr=document.createElement("button");let nr;!function(){const e=document.getElementById("9123dcbb0b42652b0e105956c68d3ca2ff34584f324fa41a29aedd32b883e131"),t=document.createElement("div"),i=document.querySelector("."+e.getAttribute("data-input")),n=()=>{e.style.boxShadow="0 0 0 5px #ccc5",setTimeout((()=>{e?.style&&(e.style.boxShadow="none")}),[50])};function s(e,t){n();var r=t.result;Zi.innerHTML+=`(recognizing) Reason: ${ce[r.reason]} Text: ${r.text}\r\n`,i.value=`${r.text} [...]\r\n`}function o(e,t){t.result,p(t.result)}function a(e,t){window.console.log(t),Zi.innerHTML+="(cancel) Reason: "+oe[t.reason],t.reason===oe.Error&&(Zi.innerHTML+=": "+t.errorDetails),Zi.innerHTML+="\r\n"}function c(e,t){d(),Zi.innerHTML+=`(sessionStarted) SessionId: ${t.sessionId}\r\n`;for(const e of tr)e.disabled=!0;ir.disabled=!0,rr.disabled=!1}function h(e,t){u(),Zi.innerHTML+=`(sessionStopped) SessionId: ${t.sessionId}\r\n`,"pronunciationAssessmentContinuous"==Yi.value&&calculateOverallPronunciationScore();for(const e of tr)e.disabled=!1;ir.disabled=!1,rr.disabled=!0}function p(e){switch("speechRecognizerRecognizeOnce"===Yi.value||"intentRecognizerRecognizeOnce"===Yi.value?i.innerHTML="":i.innerHTML=i.innerHTML.replace(/(.*)(^|[\r\n]+).*\[\.\.\.\][\r\n]+/,"$1$2"),e.reason){case ce.NoMatch:var t=yt.fromResult(e);Zi.innerHTML+=` NoMatchReason: ${pt[t.reason]}\r\n`;break;case ce.Canceled:var n=It.fromResult(e);Zi.innerHTML+=` CancellationReason: ${oe[n.reason]}`,n.reason===oe.Error&&n.errorDetails;break;case ce.RecognizedSpeech:case ce.TranslatedSpeech:case ce.RecognizedIntent:if(Zi.innerHTML+="\r\n",Xi){var s=JSON.parse(e.json),o=s.DisplayText;i.innerHTML+=`Detailed result for "${o}":\r\n${JSON.stringify(s,null,2)}\r\n`}else e.text&&(i.value=e.text.toLocaleLowerCase().replaceAll(/[^[\w| ]]*/g,""));var a=e.properties.getProperty(r.LanguageUnderstandingServiceResponse_JsonResult);if(a&&(console.info("unused functionality"),i.innerHTML+=`${a}\r\n`),e.translations&&(console.info("unused functionality"),JSON.parse(e.json).privTranslationPhrase.Translation.Translations.forEach((function(e){i.innerHTML+=` [${e.Language}] ${e.Text}\r\n`}))),Yi.value.includes("pronunciation")){console.info("unused functionality");var c=Pt.fromResult(e);i.innerHTML+=`[Pronunciation result] Accuracy: ${c.accuracyScore}; \n                       Fluency: ${c.fluencyScore};\n                       Completeness: ${c.completenessScore}.\n`,er.push(c)}}}const u=()=>{e.setAttribute("data-recording","false"),t.innerHTML=Ji()},d=()=>{e.setAttribute("data-recording","true"),t.innerHTML=Vi()};e.style="width: 20px; height: 20px; border-radius: 20px; padding: 10px; background-color: #ccc5",e.style.transition="background-color 0.1s",e.append(t),u(),e.onclick=()=>{"true"!==e.getAttribute("data-recording")?function(){const e=ft.fromMicrophoneInput("Default Microphone"),t=function(e){let t=e.fromSubscription($i,Gi);return t.speechRecognitionLanguage=Qi,t}(bt);var r;e&&t&&(nr=new Hi(t,e),(r=nr).recognizing=s,r.recognized=o,r.canceled=a,r.sessionStarted=c,r.sessionStopped=h,nr.recognized=void 0,nr.recognizeOnceAsync((function(e){p(e)}),(function(e){console.error(e),i.innerHTML+="ERROR: "+e})))}():(nr.close(),nr=void 0)}}()})()})();
